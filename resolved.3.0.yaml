openapi: 3.0.3
info:
  title: Self Assessment Accounts (MTD)
  description: "The following group of endpoints is stateful in the Sandbox:\n* <a\
    \ href=\"#tag/Coding-Out-Underpayments-and-Debts\">Coding Out Underpayments and\
    \ Debts</a>\n* <a href=\"#tag/Coding-Out-Status\">Coding Out Status</a>\n\n# Send\
    \ fraud prevention data\nHMRC monitors transactions to help protect your customers'\
    \ confidential data from criminals and fraudsters. \n\n<div class=\"govuk-warning-text\
    \ warning-icon-fix\">\n  <span class=\"govuk-warning-text__icon warning-icon-ui-fix\"\
    \ aria-hidden=\"true\">!</span>\n  <strong class=\"govuk-warning-text__text\"\
    >\n    <span class=\"govuk-warning-text__assistive\">Warning</span>\n    You are\
    \ required by law to submit header data for this API. This includes all associated\
    \ APIs and endpoints.\n  </strong>\n</div>\n\n[Check the data you need to send](/guides/fraud-prevention/).\
    \ You can also use the [Test API](/api-documentation/docs/api/service/txm-fph-validator-api/1.0)\
    \ during initial development and as part of your quality assurance checks.\n\n\
    # Mapping APIs to Self Assessment tax return forms\nSome parameters in this API\
    \ map to box numbers in one or more Self Assessment tax return forms. To learn\
    \ more and to download this mapping information as a CSV file, go to [income-tax-mtd-changelog/mapping](https://github.com/hmrc/income-tax-mtd-changelog?tab=readme-ov-file#mapping-apis-to-self-assessment-tax-return-forms)\
    \ on GitHub.\n\n# Changelog\nYou can find the changelog in the [income-tax-mtd-changelog](https://github.com/hmrc/income-tax-mtd-changelog/#readme)\
    \ on GitHub.\n\n# Support\n* Direct reports of bugs or errors in Production or\
    \ Sandbox code, or queries about HMRC business functionality (such as how a specific\
    \ field is used by HMRC or why it is needed) to the [Software Development Support\
    \ Team (SDST)](https://developer.service.hmrc.gov.uk/developer/support).\n* Send\
    \ queries or feedback related to the design of the APIs (including recommended\
    \ changes) using the [income-tax-mtd-changelog](https://github.com/hmrc/income-tax-mtd-changelog/issues)\
    \ GitHub page.\n* <a href=\"/contact/report-technical-problem?newTab=true&service=api-documentation-frontend\"\
    \ target=\"_blank\">Is this page not working properly? (opens in new tab)</a>\n"
  version: "3.0"
servers:
- url: https://test-api.service.hmrc.gov.uk
  description: Sandbox
- url: https://api.service.hmrc.gov.uk
  description: Production
tags:
- name: Payments and Liabilities
  description: "These endpoints allow a developer to retrieve accounting information\
    \ to be shown back to the customer. This includes listing payments the customer\
    \ has made, how these payments have been allocated and details of any upcoming\
    \ or outstanding liabilities. The data returned only relates to payments and liabilities\
    \ arising for tax years since the customer joined the new service. There may also\
    \ be outstanding liabilities and payment information a customer needs to view\
    \ for the years prior to signing up to Making Tax Digital for Income Tax Self\
    \ Assessment that can be viewed using their existing Personal Tax Account.<br><br>"
- name: Coding Out Underpayments and Debts
  description: "Coding out is a concept used to retrieve underpaid tax and debts through\
    \ a taxpayers PAYE tax code.<br><br> The coding out underpayments and debts endpoints\
    \ allow software packages to overwrite coding out underpayment and debt amounts\
    \ that are held by HMRC for a previous tax year and given NINO. Software packages\
    \ can then amend previously submitted overwrite amounts, retrieve the HMRC held\
    \ or user submitted coding out amounts or delete the user submitted amounts.<br><br>"
- name: Coding Out Status
paths:
  /accounts/self-assessment/{nino}/charges/{transactionId}:
    get:
      tags:
      - Payments and Liabilities
      summary: Retrieve History of a Self Assessment Charge
      description: "This endpoint enables you to retrieve the history of changes to\
        \ an individual charge. A National Insurance number and transaction ID must\
        \ be provided. \nYou can get the transaction ID using the Retrieve Self Assessment\
        \ Balance and Transactions endpoint - it is returned as documentId in the\
        \ documentDetails array.\n    \n### Test data\nScenario simulation using Gov-Test-Scenario\
        \ headers is only available in the sandbox environment.\n\n| Header Value\
        \ (Gov-Test-Scenario) | Scenario                                       |\n\
        |----------------------------------|------------------------------------------------|\n\
        | N/A - DEFAULT                    | Simulates success response.         \
        \           |\n| NOT_FOUND                        | Simulates the scenario\
        \ where no data is found. |   \n"
      parameters:
      - name: nino
        in: path
        description: |
          National Insurance number, in the format `AA999999A`.
        required: true
        schema:
          type: string
          example: TC663795B
      - name: transactionId
        in: path
        description: "A unique identifier for this item. \n\nMust conform to the regular\
          \ expression\n^[0-9A-Za-z]{1,12}$\n"
        required: true
        schema:
          type: string
          example: X92AM39DLE3D
      - name: Accept
        in: header
        description: |
          Specifies the response format and the version of the API to be used.
        required: true
        schema:
          type: string
          enum:
          - application/vnd.hmrc.3.0+json
      - name: Authorization
        in: header
        description: |
          An OAuth 2.0 Bearer Token with the *read:self-assessment* scope.
        required: true
        schema:
          type: string
          example: Bearer bb7fed3fe10dd235a2ccda3d50fb
      - name: Gov-Test-Scenario
        in: header
        description: |
          Only in sandbox environment. See Test Data table for all header values.
        required: false
        schema:
          type: string
          example: "-"
      responses:
        "200":
          description: Success
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                title: Retrieve History of a Self Assessment Charge
                required:
                - chargeHistoryDetails
                type: object
                properties:
                  chargeHistoryDetails:
                    type: array
                    description: A list of changes to a particular charge
                    items:
                      title: changeDetails
                      required:
                      - changeDate
                      - changeReason
                      - changeTimestamp
                      - description
                      - totalAmount
                      - transactionDate
                      - transactionId
                      type: object
                      properties:
                        taxYear:
                          type: string
                          description: "The tax year that this charge relates to in\
                            \ the format: YYYY-YY."
                          example: 2022-23
                        transactionId:
                          type: string
                          description: "A unique identifier used to return a single\
                            \ charge. Must conform to the regular expression ^[A-Za-z0-9]{1,12}$"
                          example: X123456790A
                        transactionDate:
                          type: string
                          description: "The date the charge was created in the format:\
                            \ YYYY-MM-DD."
                          example: 2018-04-05
                        description:
                          type: string
                          description: Primary method to identify what type of charge
                            has been called.
                          example: "POA1, Balancing charge"
                        totalAmount:
                          multipleOf: 0.01
                          maximum: 99999999999.99
                          minimum: -99999999999.99
                          type: number
                          description: The value of the charge following the change.
                            The value must be between -99999999999.99 and 99999999999.99
                            up to 2 decimal places.
                          example: 600.00
                        changeDate:
                          type: string
                          description: "The date the charge was changed, in the format:\
                            \ YYYY-MM-DD. This field is deprecated and will be removed\
                            \ in a future release. Use changeTimestamp instead."
                          format: date
                          example: 2018-04-05
                          deprecated: true
                        changeTimestamp:
                          type: string
                          description: "[Test only] The timestamp the charge was changed,\
                            \ in the format: YYYY-MM-DDThh:mm:ss.SSSZ"
                          format: date-time
                          example: 2018-04-05T14:15:22.802Z
                        changeReason:
                          type: string
                          description: The reason for the change.
                          example: " Amended return, Customer Request"
                        poaAdjustmentReason:
                          type: string
                          description: "A numeric code indicating the reason for adjustment\
                            \ to Payments on Account. \n\nThe possible values (with\
                            \ their meanings) are:\n\n001: Profits for the business\
                            \ are down/the business has ceased\n\n002: Other income\
                            \ has gone down\n\n003: Tax Allowances and reliefs have\
                            \ gone up\n\n004: Tax deducted at source is more than\
                            \ previous year\n\n005: Increasing the PoA after a prior\
                            \ adjustment\n\nFor example: 004"
                          example: "004"
                description: This endpoint enables you to retrieve the history of
                  changes to a single charge made by HMRC. A National Insurance number
                  and transaction ID must be provided.
              examples:
                Request:
                  value:
                    $ref: ./examples/retrieveSelfAssementChargeHistory/def1/response.json
        "400":
          description: Bad request
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                required:
                - code
                type: object
                properties:
                  code:
                    type: string
                    description: The error code
                  message:
                    type: string
                    description: The error message
                description: Error Response
              examples:
                FORMAT_NINO:
                  description: |
                    The format of the supplied nino value is invalid.
                  value:
                    code: FORMAT_NINO
                    message: The format of the supplied nino value is invalid.
                FORMAT_TRANSACTION_ID:
                  description: |
                    The format of the supplied transaction identifier field is not valid.
                  value:
                    code: FORMAT_TRANSACTION_ID
                    message: The format of the supplied transaction identifier field
                      is not valid0
                RULE_INCORRECT_GOV_TEST_SCENARIO:
                  description: "The request did not match any available Sandbox data.\
                    \ Check that the supplied Gov-Test-Scenario is correct for \n\
                    this endpoint version. This error will only be returned in the\
                    \ Sandbox environment.\n"
                  value:
                    code: RULE_INCORRECT_GOV_TEST_SCENARIO
                    message: The supplied Gov-Test-Scenario is not valid
        "403":
          description: Forbidden
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                required:
                - code
                type: object
                properties:
                  code:
                    type: string
                    description: The error code
                  message:
                    type: string
                    description: The error message
                description: Error Response
              examples:
                CLIENT_OR_AGENT_NOT_AUTHORISED:
                  description: |
                    'The client or agent is not authorised. This is because: the client is not enrolled for MTD, the agent is not enrolled for Agent Services, the client has not authorised the agent to act on their behalf, or the Authorization token provided is not correct.'
                  value:
                    code: CLIENT_OR_AGENT_NOT_AUTHORISED
                    message: "The client or agent is not authorised. This is because:\
                      \ the client is not enrolled for MTD, the agent is not enrolled\
                      \ for Agent Services, the client has not authorised the agent\
                      \ to act on their behalf, or the Authorization token provided\
                      \ is not correct."
        "404":
          description: Not found
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                required:
                - code
                type: object
                properties:
                  code:
                    type: string
                    description: The error code
                  message:
                    type: string
                    description: The error message
                description: Error Response
              examples:
                NOT_FOUND:
                  description: |
                    Matching resource not found.
                  value:
                    code: MATCHING_RESOURCE_NOT_FOUND
                    message: Matching resource not found
      security:
      - User-Restricted:
        - read:self-assessment
  /accounts/self-assessment/{nino}/charges/transactionId/{transactionId}:
    get:
      tags:
      - Payments and Liabilities
      summary: Retrieve History of a Self Assessment Charge by Transaction ID
      description: "This endpoint enables you to retrieve the history of a Self Assessment\
        \ charge made by HMRC using a transaction ID. A National Insurance number\
        \ and transaction ID must be provided.\n\n### Test data\nScenario simulation\
        \ using Gov-Test-Scenario headers is only available in the sandbox environment.\n\
        \n| Header Value (Gov-Test-Scenario) | Scenario                          \
        \             |\n|----------------------------------|------------------------------------------------|\n\
        | N/A - DEFAULT                    | Simulates success response.         \
        \           |\n| NOT_FOUND                        | Simulates the scenario\
        \ where no data is found. |   \n"
      parameters:
      - name: nino
        in: path
        description: |
          National Insurance number, in the format `AA999999A`.
        required: true
        schema:
          type: string
          example: TC663795B
      - name: transactionId
        in: path
        description: "A unique identifier for this item. \n\nMust conform to the regular\
          \ expression\n^[0-9A-Za-z]{1,12}$\n"
        required: true
        schema:
          type: string
          example: X92AM39DLE3D
      - name: Accept
        in: header
        description: |
          Specifies the response format and the version of the API to be used.
        required: true
        schema:
          type: string
          enum:
          - application/vnd.hmrc.3.0+json
      - name: Authorization
        in: header
        description: |
          An OAuth 2.0 Bearer Token with the *read:self-assessment* scope.
        required: true
        schema:
          type: string
          example: Bearer bb7fed3fe10dd235a2ccda3d50fb
      - name: Gov-Test-Scenario
        in: header
        description: |
          Only in sandbox environment. See Test Data table for all header values.
        required: false
        schema:
          type: string
          example: "-"
      responses:
        "200":
          description: Success
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                title: Retrieve History of a Self Assessment Charge
                required:
                - chargeHistoryDetails
                type: object
                properties:
                  chargeHistoryDetails:
                    type: array
                    description: A list of changes to a particular charge
                    items:
                      title: changeDetails
                      required:
                      - changeDate
                      - changeReason
                      - changeTimestamp
                      - description
                      - totalAmount
                      - transactionDate
                      - transactionId
                      type: object
                      properties:
                        taxYear:
                          type: string
                          description: "The tax year that this charge relates to in\
                            \ the format: YYYY-YY."
                          example: 2022-23
                        transactionId:
                          type: string
                          description: "A unique identifier used to return a single\
                            \ charge. Must conform to the regular expression ^[A-Za-z0-9]{1,12}$"
                          example: X123456790A
                        transactionDate:
                          type: string
                          description: "The date the charge was created in the format:\
                            \ YYYY-MM-DD."
                          example: 2018-04-05
                        description:
                          type: string
                          description: Primary method to identify what type of charge
                            has been called.
                          example: "POA1, Balancing charge"
                        totalAmount:
                          multipleOf: 0.01
                          maximum: 99999999999.99
                          minimum: -99999999999.99
                          type: number
                          description: The value of the charge following the change.
                            The value must be between -99999999999.99 and 99999999999.99
                            up to 2 decimal places.
                          example: 600.00
                        changeDate:
                          type: string
                          description: "The date the charge was changed, in the format:\
                            \ YYYY-MM-DD. This field is deprecated and will be removed\
                            \ in a future release. Use changeTimestamp instead."
                          format: date
                          example: 2018-04-05
                          deprecated: true
                        changeTimestamp:
                          type: string
                          description: "[Test only] The timestamp the charge was changed,\
                            \ in the format: YYYY-MM-DDThh:mm:ss.SSSZ"
                          format: date-time
                          example: 2018-04-05T14:15:22.802Z
                        changeReason:
                          type: string
                          description: The reason for the change.
                          example: " Amended return, Customer Request"
                        poaAdjustmentReason:
                          type: string
                          description: "A numeric code indicating the reason for adjustment\
                            \ to Payments on Account. \n\nThe possible values (with\
                            \ their meanings) are:\n\n001: Profits for the business\
                            \ are down/the business has ceased\n\n002: Other income\
                            \ has gone down\n\n003: Tax Allowances and reliefs have\
                            \ gone up\n\n004: Tax deducted at source is more than\
                            \ previous year\n\n005: Increasing the PoA after a prior\
                            \ adjustment\n\nFor example: 004"
                          example: "004"
                description: This endpoint enables you to retrieve the history of
                  changes to a single charge made by HMRC. A National Insurance number
                  and transaction ID must be provided.
              examples:
                Request:
                  value:
                    $ref: ./examples/retrieveSelfAssementChargeHistory/def1/response.json
        "400":
          description: Bad request
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                required:
                - code
                type: object
                properties:
                  code:
                    type: string
                    description: The error code
                  message:
                    type: string
                    description: The error message
                description: Error Response
              examples:
                FORMAT_NINO:
                  description: |
                    The format of the supplied nino value is invalid.
                  value:
                    code: FORMAT_NINO
                    message: The format of the supplied nino value is invalid.
                FORMAT_TRANSACTION_ID:
                  description: |
                    The format of the supplied transaction identifier field is not valid.
                  value:
                    code: FORMAT_TRANSACTION_ID
                    message: The format of the supplied transaction identifier field
                      is not valid0
                RULE_INCORRECT_GOV_TEST_SCENARIO:
                  description: "The request did not match any available Sandbox data.\
                    \ Check that the supplied Gov-Test-Scenario is correct for \n\
                    this endpoint version. This error will only be returned in the\
                    \ Sandbox environment.\n"
                  value:
                    code: RULE_INCORRECT_GOV_TEST_SCENARIO
                    message: The supplied Gov-Test-Scenario is not valid
        "403":
          description: Forbidden
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                required:
                - code
                type: object
                properties:
                  code:
                    type: string
                    description: The error code
                  message:
                    type: string
                    description: The error message
                description: Error Response
              examples:
                CLIENT_OR_AGENT_NOT_AUTHORISED:
                  description: |
                    'The client or agent is not authorised. This is because: the client is not enrolled for MTD, the agent is not enrolled for Agent Services, the client has not authorised the agent to act on their behalf, or the Authorization token provided is not correct.'
                  value:
                    code: CLIENT_OR_AGENT_NOT_AUTHORISED
                    message: "The client or agent is not authorised. This is because:\
                      \ the client is not enrolled for MTD, the agent is not enrolled\
                      \ for Agent Services, the client has not authorised the agent\
                      \ to act on their behalf, or the Authorization token provided\
                      \ is not correct."
        "404":
          description: Not found
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                required:
                - code
                type: object
                properties:
                  code:
                    type: string
                    description: The error code
                  message:
                    type: string
                    description: The error message
                description: Error Response
              examples:
                NOT_FOUND:
                  description: |
                    Matching resource not found.
                  value:
                    code: MATCHING_RESOURCE_NOT_FOUND
                    message: Matching resource not found
      security:
      - User-Restricted:
        - read:self-assessment
  /accounts/self-assessment/{nino}/charges/chargeReference/{chargeReference}:
    get:
      tags:
      - Payments and Liabilities
      summary: Retrieve History of a Self Assessment Charge by Charge Reference
      description: "This endpoint enables you to retrieve the history of a Self Assessment\
        \ charge made by HMRC using a charge reference number. A National Insurance\
        \ number and charge reference number must be provided.\n\n### Test data\n\
        Scenario simulation using Gov-Test-Scenario headers is only available in the\
        \ sandbox environment.\n\n| Header Value (Gov-Test-Scenario) | Scenario  \
        \                                     |\n|----------------------------------|------------------------------------------------|\n\
        | N/A - DEFAULT                    | Simulates success response.         \
        \           |\n| NOT_FOUND                        | Simulates the scenario\
        \ where no data is found. |   \n"
      parameters:
      - name: nino
        in: path
        description: |
          National Insurance number, in the format `AA999999A`.
        required: true
        schema:
          type: string
          example: TC663795B
      - name: chargeReference
        in: path
        description: "This field will be used when the need is to view a specific\
          \ document with help of Charge Reference number \n\nMust conform to the\
          \ regular expression\n^[A-Za-z]{2}[0-9]{12}$\n"
        required: true
        schema:
          type: string
          example: Ck106547829351
      - name: Accept
        in: header
        description: |
          Specifies the response format and the version of the API to be used.
        required: true
        schema:
          type: string
          enum:
          - application/vnd.hmrc.3.0+json
      - name: Authorization
        in: header
        description: |
          An OAuth 2.0 Bearer Token with the *read:self-assessment* scope.
        required: true
        schema:
          type: string
          example: Bearer bb7fed3fe10dd235a2ccda3d50fb
      - name: Gov-Test-Scenario
        in: header
        description: |
          Only in sandbox environment. See Test Data table for all header values.
        required: false
        schema:
          type: string
          example: "-"
      responses:
        "200":
          description: Success
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                title: Retrieve History of a Self Assessment Charge
                required:
                - chargeHistoryDetails
                type: object
                properties:
                  chargeHistoryDetails:
                    type: array
                    description: A list of changes to a particular charge
                    items:
                      title: changeDetails
                      required:
                      - changeDate
                      - changeReason
                      - changeTimestamp
                      - description
                      - totalAmount
                      - transactionDate
                      - transactionId
                      type: object
                      properties:
                        taxYear:
                          type: string
                          description: "The tax year that this charge relates to in\
                            \ the format: YYYY-YY."
                          example: 2022-23
                        transactionId:
                          type: string
                          description: "A unique identifier used to return a single\
                            \ charge. Must conform to the regular expression ^[A-Za-z0-9]{1,12}$"
                          example: X123456790A
                        transactionDate:
                          type: string
                          description: "The date the charge was created in the format:\
                            \ YYYY-MM-DD."
                          example: 2018-04-05
                        description:
                          type: string
                          description: Primary method to identify what type of charge
                            has been called.
                          example: "POA1, Balancing charge"
                        totalAmount:
                          multipleOf: 0.01
                          maximum: 99999999999.99
                          minimum: -99999999999.99
                          type: number
                          description: The value of the charge following the change.
                            The value must be between -99999999999.99 and 99999999999.99
                            up to 2 decimal places.
                          example: 600.00
                        changeDate:
                          type: string
                          description: "The date the charge was changed, in the format:\
                            \ YYYY-MM-DD. This field is deprecated and will be removed\
                            \ in a future release. Use changeTimestamp instead."
                          format: date
                          example: 2018-04-05
                          deprecated: true
                        changeTimestamp:
                          type: string
                          description: "[Test only] The timestamp the charge was changed,\
                            \ in the format: YYYY-MM-DDThh:mm:ss.SSSZ"
                          format: date-time
                          example: 2018-04-05T14:15:22.802Z
                        changeReason:
                          type: string
                          description: The reason for the change.
                          example: " Amended return, Customer Request"
                        poaAdjustmentReason:
                          type: string
                          description: "A numeric code indicating the reason for adjustment\
                            \ to Payments on Account. \n\nThe possible values (with\
                            \ their meanings) are:\n\n001: Profits for the business\
                            \ are down/the business has ceased\n\n002: Other income\
                            \ has gone down\n\n003: Tax Allowances and reliefs have\
                            \ gone up\n\n004: Tax deducted at source is more than\
                            \ previous year\n\n005: Increasing the PoA after a prior\
                            \ adjustment\n\nFor example: 004"
                          example: "004"
                description: This endpoint enables you to retrieve the history of
                  changes to a single charge made by HMRC. A National Insurance number
                  and transaction ID must be provided.
              examples:
                Request:
                  value:
                    $ref: ./examples/retrieveSelfAssementChargeHistory/def1/response.json
        "400":
          description: Bad request
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                required:
                - code
                type: object
                properties:
                  code:
                    type: string
                    description: The error code
                  message:
                    type: string
                    description: The error message
                description: Error Response
              examples:
                FORMAT_NINO:
                  description: |
                    The format of the supplied nino value is invalid.
                  value:
                    code: FORMAT_NINO
                    message: The format of the supplied nino value is invalid.
                FORMAT_CHARGE_REFERENCE:
                  description: |
                    The format of the supplied charge reference is not valid.
                  value:
                    code: FORMAT_CHARGE_REFERENCE
                    message: The provided charge reference is invalid
                RULE_INCORRECT_GOV_TEST_SCENARIO:
                  description: "The request did not match any available Sandbox data.\
                    \ Check that the supplied Gov-Test-Scenario is correct for \n\
                    this endpoint version. This error will only be returned in the\
                    \ Sandbox environment.\n"
                  value:
                    code: RULE_INCORRECT_GOV_TEST_SCENARIO
                    message: The supplied Gov-Test-Scenario is not valid
        "403":
          description: Forbidden
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                required:
                - code
                type: object
                properties:
                  code:
                    type: string
                    description: The error code
                  message:
                    type: string
                    description: The error message
                description: Error Response
              examples:
                CLIENT_OR_AGENT_NOT_AUTHORISED:
                  description: |
                    'The client or agent is not authorised. This is because: the client is not enrolled for MTD, the agent is not enrolled for Agent Services, the client has not authorised the agent to act on their behalf, or the Authorization token provided is not correct.'
                  value:
                    code: CLIENT_OR_AGENT_NOT_AUTHORISED
                    message: "The client or agent is not authorised. This is because:\
                      \ the client is not enrolled for MTD, the agent is not enrolled\
                      \ for Agent Services, the client has not authorised the agent\
                      \ to act on their behalf, or the Authorization token provided\
                      \ is not correct."
        "404":
          description: Not found
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                required:
                - code
                type: object
                properties:
                  code:
                    type: string
                    description: The error code
                  message:
                    type: string
                    description: The error message
                description: Error Response
              examples:
                NOT_FOUND:
                  description: |
                    Matching resource not found.
                  value:
                    code: MATCHING_RESOURCE_NOT_FOUND
                    message: Matching resource not found
      security:
      - User-Restricted:
        - read:self-assessment
  /accounts/self-assessment/{nino}/balance-and-transactions:
    get:
      tags:
      - Payments and Liabilities
      summary: Retrieve Self Assessment Balance and Transactions
      description: |
        This endpoint enables you to retrieve the overall liability broken down into overdue, currently due (payable), and pending (not yet due) amounts. A National Insurance number must be provided.

        ### Test data
        Scenario simulation using Gov-Test-Scenario headers is only available in the sandbox environment.

        | Header Value (Gov-Test-Scenario) | Scenario                                                            |
        |----------------------------------|---------------------------------------------------------------------|
        | N/A - DEFAULT                    | Simulates success response.                                         |
        | NOT_FOUND                        | Simulates the scenario where no data is found.                      |
      parameters:
      - name: nino
        in: path
        description: |
          National Insurance number, in the format `AA999999A`.
        required: true
        schema:
          type: string
          example: TC663795B
      - name: docNumber
        in: query
        description: |
          The docNumber is a unique number per tax grouping in the Account display.
          (When onlyOpenItems has been set to false, either the date range (fromDate and toDate) or doc number should be supplied.)
        required: false
        schema:
          type: string
          example: "3060013199"
      - name: fromDate
        in: query
        description: The inclusive start date of the period to filter payments. The
          maximum date range between fromDate and toDate should not exceed 732 days.
        required: false
        schema:
          type: string
          example: 2019-01-02
      - name: toDate
        in: query
        description: The inclusive end date of the period to filter payments. The
          maximum date range between fromDate and toDate should not exceed 732 days.
        required: false
        schema:
          type: string
          example: 2019-01-02
      - name: onlyOpenItems
        in: query
        description: |
          Limits the extraction to unpaid or not reversed charges.

          (When onlyOpenItems has been set to false, either the date range (fromDate and toDate) or docNumber should be supplied.)

          Defaults to false
        required: false
        schema:
          type: boolean
          example: false
      - name: includeLocks
        in: query
        description: |
          Include additional information related to claim and debt management.

          Defaults to false
        required: false
        schema:
          type: boolean
          example: true
      - name: calculateAccruedInterest
        in: query
        description: |
          Calculate accrued interest. Accruing interest is the amount of interest calculated

          a) To todays date (or in the case of a created statement, to the statement date)

          b) On any overdue interest-bearing liability

          No interest charge is created for an amount of accruing interest. An interest charge is only created when the related liability is paid in full.
        required: false
        schema:
          type: boolean
          example: false
      - name: removePOA
        in: query
        description: |
          Remove Payment on Account details. When true, details of any payments that the customer has made will not be returned.

          Defaults to false.
        required: false
        schema:
          type: boolean
          example: false
      - name: customerPaymentInformation
        in: query
        description: |
          Include customer payment information in the response. When true, the following information is returned:
          Payment Reference, Payment Amount, Payment Method, Payment Lot, Payment Lot Item, Clearing SAP Document.

          Note that if removePOA is true, no information is returned even if customerPaymentInformation is true.

          Defaults to false.
        required: false
        schema:
          type: boolean
          example: false
      - name: includeEstimatedCharges
        in: query
        description: |
          Include statistical (estimated) values for monthly payments.

          Defaults to false.
        required: false
        schema:
          type: boolean
          example: true
      - name: Accept
        in: header
        description: |
          Specifies the response format and the version of the API to be used.
        required: true
        schema:
          type: string
          enum:
          - application/vnd.hmrc.3.0+json
      - name: Authorization
        in: header
        description: |
          An OAuth 2.0 Bearer Token with the *read:self-assessment* scope.
        required: true
        schema:
          type: string
          example: Bearer bb7fed3fe10dd235a2ccda3d50fb
      - name: Gov-Test-Scenario
        in: header
        description: |
          Only in sandbox environment. See Test Data table for all header values.
        required: false
        schema:
          type: string
          example: "-"
      responses:
        "200":
          description: Success
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                title: Retrieve Self Assessment Balance and Transactions
                required:
                - balanceDetails
                type: object
                properties:
                  balanceDetails:
                    required:
                    - bcdBalancePerYear
                    - overdueAmount
                    - payableAmount
                    - pendingChargeDueAmount
                    - totalBalance
                    type: object
                    properties:
                      payableAmount:
                        type: number
                        description: The sum of any non-zero charges whose payment
                          due date is within 30 days. The value must be between -99999999999.99
                          and 99999999999.99 to 2 decimal places.
                        example: 5009.99
                      payableDueDate:
                        type: string
                        description: Next payment date for charges due in the format
                          YYYY-MM-DD.
                        example: 2018-04-05
                      pendingChargeDueAmount:
                        type: number
                        description: The sum of any charges whose payment is pending
                          (not yet due). The value must be between -99999999999.99
                          and 99999999999.99 to 2 decimal places.
                        example: 5009.99
                      pendingChargeDueDate:
                        type: string
                        description: The date by when the next pending (not yet due)
                          charge must be paid in the format YYYY-MM-DD.
                        example: 2018-04-05
                      overdueAmount:
                        type: number
                        description: "The total amount of charges under each documentID\
                          \ whose due date is in the past Accrued Interest Amount\
                          \ / LPI Amount will also be included (where applicable).\
                          \ \r\n The value must be between -99999999999.99 and 99999999999.99\
                          \ to 2 decimal places."
                        example: 5009.99
                      bcdBalancePerYear:
                        type: array
                        description: An array containing balance charge debit payment
                          details.
                        items:
                          required:
                          - bcdAmount
                          - taxYear
                          type: object
                          properties:
                            taxYear:
                              type: string
                              description: The tax year for the appropriate balance
                                charge debit.
                              example: 2018-19
                            bcdAmount:
                              type: number
                              description: "The balancing charge debit amount is the\
                                \ balancing payment due by the taxpayer calculated\
                                \ when the return is captured.\r\nThe value must be\
                                \ between -99999999999.99 and 99999999999.99 to 2\
                                \ decimal places."
                              example: 5009.99
                      earliestPaymentDateOverdue:
                        type: string
                        description: The next day after the payment due date in the
                          format YYYY-MM-DD
                        example: 2018-04-05
                      totalBalance:
                        type: number
                        description: "The sum of all the unpaid charges excluding\
                          \ statistical and  EOY coded out. The total balance should\
                          \ be equal to the sum of the balance due within 30 days,\
                          \ balance not due in 30 days, and overdue amount.\r\nThe\
                          \ value must be between -99999999999.99 and 99999999999.99\
                          \ to 2 decimal places."
                        example: 5009.99
                      amountCodedOut:
                        type: number
                        description: "The total amount of underpayment codeout.\r\n\
                          The value must be between -99999999999.99 and 99999999999.99\
                          \ to 2 decimal places."
                        example: 5009.99
                      totalBcdBalance:
                        type: number
                        description: "The total of the Balance charge debit balance\
                          \ amount.\r\nThe value must be between -99999999999.99 and\
                          \ 99999999999.99 to 2 decimal places"
                        example: 5009.99
                      unallocatedCredit:
                        type: number
                        description: "Sum of all the Open credit Items on the customer's\
                          \ account, posted for Income tax Self-assessment.\r\nThe\
                          \ value must be between -99999999999.99 and 99999999999.99\
                          \ to 2 decimal places."
                        example: 5009.99
                      allocatedCredit:
                        type: number
                        description: "Sum of all the closed credit items on the customer's\
                          \ account, posted for  Income tax Self-assessment.\r\nThe\
                          \ value must be between -99999999999.99 and 99999999999.99\
                          \ to 2 decimal places."
                        example: 5009.99
                      totalCredit:
                        type: number
                        description: "Sum of unallocated credit + allocated credit.\r\
                          \nThe value must be between -99999999999.99 and 99999999999.99\
                          \ to 2 decimal places."
                        example: 5009.99
                      firstPendingAmountRequested:
                        type: number
                        description: "This will be the first pending amount that is\
                          \ requested.\r\nThe value must be between -99999999999.99\
                          \ and 99999999999.99 to 2 decimal places."
                        example: 5009.99
                      secondPendingAmountRequested:
                        type: number
                        description: "This will be the second pending amount that\
                          \ is requested.\r\nThe value must be between -99999999999.99\
                          \ and 99999999999.99 to 2 decimal places."
                        example: 5009.99
                      availableCredit:
                        type: number
                        description: "This will be equal to total credit minus the\
                          \ pending amount(s) requested.\r\nThe value must be between\
                          \ -99999999999.99 and 99999999999.99 to 2 decimal places."
                        example: 5009.99
                  codingDetails:
                    title: Retrieve coding details
                    type: array
                    description: An Object containing coding details
                    items:
                      type: object
                      properties:
                        returnTaxYear:
                          type: string
                          description: The ending year of the tax year to which the
                            return relates is in the format YYYY-YY.
                          example: 2021-22
                        totalLiabilityAmount:
                          multipleOf: 0.01
                          maximum: 99999999999.99
                          minimum: -99999999999.99
                          type: number
                          description: The total amount of the Self Assessment tax
                            return inclusive of coded charges. The value must be between
                            -99999999999.99 and 99999999999.99 up to 2 decimal places.
                          example: 5009.99
                        codingTaxYear:
                          type: string
                          description: The tax year that the coded out charge will
                            be attached to.
                          example: 2021-22
                        coded:
                          type: object
                          properties:
                            charge:
                              multipleOf: 0.01
                              maximum: 99999999999.99
                              minimum: -99999999999.99
                              type: number
                              description: The coded out charge. The value must be
                                between -99999999999.99 and 99999999999.99 up to 2
                                decimal places.
                              example: 5009.99
                            initiationDate:
                              type: string
                              description: "Initiation date of the coded out charge,\
                                \ in the format YYYY-MM-DD."
                              example: 2021-04-05
                          description: An object containing a coded amount and initiation
                            date
                  documentDetails:
                    type: array
                    description: An array containing document details
                    items:
                      required:
                      - documentDate
                      - documentId
                      - isChargeEstimate
                      - isCodedOut
                      - originalAmount
                      - outstandingAmount
                      type: object
                      properties:
                        taxYear:
                          type: string
                          description: "The tax year of the Document (Billing period\
                            \ from  billing period to), in the format YYYY-YY. For\
                            \ example, the tax year 2020 to 2021 is expressed as 2020-21."
                          example: 2020-21
                        documentId:
                          type: string
                          description: "DocumentID may contain SAP document number\
                            \ or Form Bundle Number for zero-amount documents. Must\
                            \ conform to the regular expression ^[0-9a-zA-Z]{1,12}$"
                          example: "1455"
                        formBundleNumber:
                          type: string
                          description: 'The form bundle number designates a package
                            of related transactions gathered together. '
                          example: "88888888"
                        creditReason:
                          type: string
                          description: Credit Reason gives the reason as to why there
                            is a credit on the account.
                          example: Voluntary Payment
                          enum:
                          - Voluntary Payment
                          - Income tax Self Assessment Return
                          - Excess Payment
                        documentDate:
                          type: string
                          description: The date when the document for a particular
                            tax group containing charges was created in the format
                            YYYY-MM-DD.
                          example: 2018-04-05
                        documentText:
                          type: string
                          description: Provides details about the tax group that the
                            charge belongs to.
                          example: ITSA- Bal Charge
                        documentDueDate:
                          type: string
                          description: The date the item must be received in the format
                            YYYY-MM-DD.
                          example: 2021-04-05
                        documentDescription:
                          type: string
                          description: The primary method to identify what type of
                            document has been called.
                          example: ITSA- POA 1
                          enum:
                          - ITSA- POA 1
                          - ITSA - POA 2
                          - ITSA- Bal Charge
                          - New Charge
                          - Clearing Document
                          - TRM New Charge
                          - TRM Amend Charge
                          - Payment
                          - Repayment
                        originalAmount:
                          multipleOf: 0.01
                          maximum: 99999999999.99
                          minimum: -99999999999.99
                          type: number
                          description: "The original value of this transaction before\
                            \ payments, credits, or adjustments.\r\nThe value must\
                            \ be between -99999999999.99 and 99999999999.99 to 2 decimal\
                            \ places."
                          example: 5000.99
                        outstandingAmount:
                          multipleOf: 0.01
                          maximum: 99999999999.99
                          minimum: -99999999999.99
                          type: number
                          description: "The amount remaining of this transaction after\
                            \ payments, credits, or adjustments.\r\nThe value must\
                            \ be between -99999999999.99 and 99999999999.99 to 2 decimal\
                            \ places."
                          example: 5000.99
                        lastClearing:
                          type: object
                          properties:
                            lastClearingDate:
                              type: string
                              description: "The date the outstanding amount was last\
                                \ modified, in the format YYYY-MM-DD."
                              example: 2018-04-05
                            lastClearingReason:
                              type: string
                              description: "The reason for the change. For example,\
                                \ an interest charge was created."
                              example: Incoming Payment
                              enum:
                              - Incoming Payment
                              - Outgoing Payment
                              - Other
                              - Write-Off
                              - Reversal
                            lastClearedAmount:
                              multipleOf: 0.01
                              maximum: 99999999999.99
                              minimum: -99999999999.99
                              type: number
                              description: The amount the transaction was last modified
                                by. The value must be between -99999999999.99 and
                                99999999999.99 to 2 decimal places.
                              example: 5000.99
                          description: Details if the amount was previously modified.
                        isChargeEstimate:
                          type: boolean
                          description: An indicator to represent that the charge is
                            an estimate and not an actual charge. The value must be
                            true or false.
                          example: false
                        isCodedOut:
                          type: boolean
                          description: An indicator to represent that the charge has
                            been sent for coding out.
                          example: false
                        paymentLot:
                          type: string
                          description: A unique identifier for a credit that has been
                            made direct to ETMP.
                          example: AB1023456789
                        paymentLotItem:
                          type: string
                          description: A unique ID that is used in combination with
                            Payment Lot to refer to an individual payment.
                          example: "000001"
                        effectiveDateOfPayment:
                          type: string
                          description: The effective date of payment in the format
                            YYYY-MM-DD.
                          example: 2021-04-05
                        latePaymentInterest:
                          type: object
                          properties:
                            latePaymentInterestId:
                              type: string
                              description: Late Payment Interest ID is the Charge
                                Reference Number of all the monthly and final interest
                                charges of the same parent charge.
                              example: "1234567890123456"
                            accruingInterestAmount:
                              multipleOf: 0.01
                              maximum: 99999999999.99
                              minimum: -99999999999.99
                              type: number
                              description: "The total value of all the monthly interest\
                                \ charges and accruing (unposted) interest charges\
                                \ is grouped by Charge Reference level. \r\nThe value\
                                \ must be between -99999999999.99 and 99999999999.99\
                                \ to 2 decimal places.\r\n"
                              example: 5000.99
                            interestRate:
                              multipleOf: 0.01
                              maximum: 99.99
                              minimum: 0
                              type: number
                              description: The latest interest rate for late payments.
                                The value must be between 0 and 99.99 to 2 decimal
                                places.
                              example: 5.99
                            interestStartDate:
                              type: string
                              description: The date the interest charges started in
                                the format YYYY-MM-DD.
                              example: 2020-04-05
                            interestEndDate:
                              type: string
                              description: The date the interest charges ended in
                                the format YYYY-MM-DD.
                              example: 2020-05-05
                            interestAmount:
                              multipleOf: 0.01
                              maximum: 99999999999.99
                              minimum: -99999999999.99
                              type: number
                              description: "The total value of all the monthly interest\
                                \ charges and final interest charges is grouped by\
                                \ Charge Reference level.\r\nThe value must be between\
                                \ -99999999999.99 and 99999999999.99 to 2 decimal\
                                \ places."
                              example: 201.99
                            interestDunningLockAmount:
                              multipleOf: 0.01
                              maximum: 99999999999.99
                              minimum: -99999999999.99
                              type: number
                              description: "Late payment interest amount where the\
                                \  Interest is temporarily not being charged on (A\
                                \ lock has been put so the interest will not be charged\
                                \ to the customer). \r\nThe value must be between\
                                \ -99999999999.99 and 99999999999.99 to 2 decimal\
                                \ places."
                              example: 5009.99
                            interestOutstandingAmount:
                              multipleOf: 0.01
                              maximum: 99999999999.99
                              minimum: -99999999999.99
                              type: number
                              description: "TThe unpaid amount of Accruing Interest\
                                \ or Late Payment Interest. \r\nThe value must be\
                                \ between -99999999999.99 and 99999999999.99 to 2\
                                \ decimal places."
                              example: 5000.99
                          description: An object containing late payment interest
                            details.
                        amountCodedOut:
                          multipleOf: 0.01
                          maximum: 99999999999.99
                          minimum: -99999999999.99
                          type: number
                          description: "The amount from the total tax return charge\
                            \ that has been coded out. \r\nThe value must be between\
                            \ -9999.99 and 2999.99 to 2 decimal places."
                          example: 5009.99
                        reducedCharge:
                          type: object
                          properties:
                            chargeType:
                              type: string
                              description: "Document name of charge reduced. \r\n\
                                This will be the Charge type name of the original\
                                \ charge"
                              example: AA
                            documentNumber:
                              type: string
                              description: "If Charge has been reduced, and credit\
                                \ arises, the document number to be shown. \r\nThis\
                                \ will be the SAP Document number of this document"
                              example: "1234567890123456"
                            amendmentDate:
                              type: string
                              description: "Amendment date of charge that has been\
                                \ reduced. \r\nThis will be the date the charge was\
                                \ reduced/changed/reversed in the format YYYY-MM-DD."
                              example: 2018-04-05
                            taxYear:
                              type: string
                              description: "Tax Year of Charge that has been reduced.\
                                \ \r\nThis is the tax year on the original charge."
                              example: 2018-19
                          description: Details if Charge has been reduced.
                        poaRelevantAmount:
                          multipleOf: 0.01
                          maximum: 99999999999.99
                          minimum: -99999999999.99
                          type: number
                          description: "Payments on account relevant amount. \r\n\
                            The value must be between -99999999999.99 and 99999999999.99\
                            \ to 2 decimal places."
                          example: 8999.98
                      description: An object containing document details
                  financialDetails:
                    type: array
                    items:
                      required:
                      - chargeDetail
                      - items
                      - taxYear
                      type: object
                      properties:
                        taxYear:
                          type: string
                          description: "The tax year to which the charge relates,\
                            \ in the format YYYY-YY"
                          example: 2020-21
                        chargeDetail:
                          required:
                          - documentId
                          type: object
                          properties:
                            documentId:
                              type: string
                              description: "DocumentID may contain SAP document number\
                                \ or Form Bundle Number for zero-amount documents.\
                                \ Must conform to the regular expression ^[0-9a-zA-Z]{1,12}$"
                              example: XAIS12345678910
                            documentType:
                              type: string
                              description: A unique ID is used to reference the document
                                type of which this is a subitem.
                              example: "1234"
                            documentTypeDescription:
                              type: string
                              description: The Description of the main charge type
                              example: SA Balancing Charge
                            chargeType:
                              type: string
                              description: A unique ID is used to identify the type
                                of sub-item.
                              example: "3175"
                            chargeTypeDescription:
                              type: string
                              description: |-
                                Name of charge type.
                                Must conform to the regular expression:
                                ^[0-9A-Za-z]{1,30}$
                              example: Income Tax Estimate - NIC2 NI
                        taxPeriodFrom:
                          type: string
                          description: |-
                            The 'from' date of this tax period.
                            Date in the format: YYYY-MM-DD
                          example: 2020-04-06
                        taxPeriodTo:
                          type: string
                          description: |-
                            The 'to' date of this tax period.
                            Date in the format: YYYY-MM-DD
                          example: 2021-04-05
                        contractAccount:
                          type: string
                          description: A contract account is the accounting record
                            for a particular charge type.
                          example: X
                        documentNumber:
                          type: string
                          description: "Same as Document Number/ID unless on output\
                            \ there is no postings (zero amounts) then the Form Bundle\
                            \ is returned \n\nMust conform to the regular expression:\
                            \ ^[0-9A-Za-z]{1,12}$"
                          example: "1040000872"
                        documentNumberItem:
                          type: string
                          description: An identifier for this part of the overall
                            transaction is used to link an allocation and charge.
                          example: XM00
                        chargeReference:
                          type: string
                          description: A unique reference number is associated with
                            the charge.
                          example: XM002610011594
                        originalAmount:
                          type: number
                          description: |-
                            The original amount of this transaction.
                            The value must be between -99999999999.99 and 99999999999.99 to 2 decimal places.
                          example: 5009.99
                        outstandingAmount:
                          type: number
                          description: |-
                            The remaining amount is due on this transaction.
                            The value must be between -99999999999.99 and 99999999999.99 to 2 decimal places.
                          example: 5009.99
                        clearedAmount:
                          type: number
                          description: "The cleared value of this transaction. For\
                            \ example, the paid amount of a charge. \nThe value must\
                            \ be between -99999999999.99 and 99999999999.99 to 2 decimal\
                            \ places."
                          example: 5009.99
                        accruedInterest:
                          type: number
                          description: |-
                            The accrued interest of this transaction.
                            Accrued interest is interest calculated and charged.
                            The value must be between -99999999999.99 and 99999999999.99 to 2 decimal places
                          example: 5009.99
                        items:
                          title: Retrieve History of a Self Assessment Charge
                          type: array
                          description: This endpoint enables you to retrieve the history
                            of changes to a single charge made by HMRC. A National
                            Insurance number and transaction ID must be provided.
                          items:
                            type: object
                            properties:
                              itemId:
                                type: string
                                description: An identifier for the item in the list.
                                example: "001"
                              dueDate:
                                type: string
                                description: "If the requested item relates to a charge,\
                                  \ the due date is the date by which the amount is\
                                  \ due to be paid. If the requested item relates\
                                  \ to a payment, the due date refers to the date\
                                  \ the payment was made to HMRC in the format YYY-MM-DD"
                                example: 2018-04-05
                              amount:
                                multipleOf: 0.01
                                maximum: 99999999999.99
                                minimum: -99999999999.99
                                type: number
                                description: The amount that this entry changed the
                                  transaction by. The value must be between -99999999999.99
                                  and 99999999999.99 to 2 decimal places.
                                example: 5009.99
                              clearingDate:
                                type: string
                                description: "The date this entry changed the item,\
                                  \ in the format YYYY-MM-DD."
                                example: 2018-04-05
                              clearingReason:
                                type: string
                                description: The reason for the change to the item.
                                example: Incoming Payment
                                enum:
                                - Incoming Payment
                                - Outgoing Payment
                                - Reversal
                                - Manual Clearing
                                - Automatic Clearing
                              outgoingPaymentMethod:
                                type: string
                                description: "The method used to make the outgoing\
                                  \ payment. One of Repayment to Card, Payable Order\
                                  \ Repayment or BACS Payment out"
                                example: Payable Order Repayment
                                enum:
                                - Repayment to Card
                                - Payable Order Repayment
                                - BACS Payment out
                              locks:
                                required:
                                - isChargeOnHold
                                - isEstimatedChargeOnHold
                                - isInterestAccrualOnHold
                                - isInterestChargeOnHold
                                type: object
                                properties:
                                  isChargeOnHold:
                                    type: boolean
                                    description: A signal that indicates that the
                                      charge has been paused whilst under review or
                                      investigation.
                                    example: false
                                  isEstimatedChargeOnHold:
                                    type: boolean
                                    description: A clearing lock is used only for
                                      statistical or forecasted charges.
                                    example: false
                                  isInterestAccrualOnHold:
                                    type: boolean
                                    description: Indicates if the charge is not accruing
                                      interest due to a review or investigation.
                                    example: true
                                  isInterestChargeOnHold:
                                    type: boolean
                                    description: A lock has been put in so the interest
                                      will not be charged to the customer.
                                    example: true
                                description: An object holding the lock fields
                              isReturn:
                                type: boolean
                                description: "If it is true, that means the charge\
                                  \ has been generated by a return."
                                example: true
                              paymentReference:
                                type: string
                                description: A unique reference number is associated
                                  with the payment.
                                example: Ab12453535
                              paymentAmount:
                                multipleOf: 0.01
                                maximum: 99999999999.99
                                minimum: -99999999999.99
                                type: number
                                description: |-
                                  If the item relates to a payment, the payment amount is the amount of the payment received into the account.

                                  If the item relates to a charge, the payment amount is the amount that this entry changed the transaction by. The value must be between -99999999999.99 and 99999999999.99 to 2 decimal places.
                                example: 5009.99
                              paymentMethod:
                                type: string
                                description: The method used to make the payment.
                                example: BACS RECEIPTS
                              paymentLot:
                                type: string
                                description: "If the item is a payment, the payment\
                                  \ lot is a unique identifier for a credit. If the\
                                  \ item is a charge, the payment lot is a unique\
                                  \ identifier for an allocation within the charge\
                                  \ and allows you to identify where the payment came\
                                  \ from."
                                example: "81203010024"
                              paymentLotItem:
                                type: string
                                description: A unique ID is used in combination with
                                  a payment ID to refer to an individual payment or
                                  credit.
                                example: "000001"
                              clearingSAPDocument:
                                type: string
                                description: "When a payment is used against a charge,\
                                  \ this links payment and charge together."
                                example: "3350000253"
                              isChargeEstimate:
                                type: boolean
                                description: Indicates whether the item represents
                                  an estimated charge.
                                example: true
                            description: The list of items as part of the financial
                              details
                      description: A list of charges that make up the overall transaction.
                        The items may include subitems.
                additionalProperties: false
                description: "This endpoint enables you to retrieve the overall liability\
                  \ broken down into overdue, currently due (payable), and pending\
                  \ (not yet due) amounts. A National Insurance number must be provided."
              examples:
                Request:
                  value:
                    $ref: ./examples/retrieveBalanceAndTransactions/def1/fullResponse.json
        "400":
          description: Bad request
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                required:
                - code
                type: object
                properties:
                  code:
                    type: string
                    description: The error code
                  message:
                    type: string
                    description: The error message
                description: Error Response
              examples:
                FORMAT_NINO:
                  description: |
                    The format of the supplied nino value is invalid.
                  value:
                    code: FORMAT_NINO
                    message: The format of the supplied nino value is invalid.
                FORMAT_DOC_NUMBER:
                  description: |
                    The format of docNumber is not valid.
                  value:
                    code: FORMAT_DOC_NUMBER
                    message: The format of docNumber is not valid.
                FORMAT_ONLY_OPEN_ITEMS:
                  description: |
                    The format of onlyOpenItem is not valid.
                  value:
                    code: FORMAT_ONLY_OPEN_ITEMS
                    message: The format of onlyOpenItem is not valid.
                FORMAT_INCLUDE_LOCKS:
                  description: |
                    The format of includeLocks is not valid.
                  value:
                    code: FORMAT_INCLUDE_LOCKS
                    message: The format of includeLocks is not valid.
                FORMAT_CALCULATE_ACCRUED_INTEREST:
                  description: |
                    The format for calculatingAccruedInterest is not valid.
                  value:
                    code: FORMAT_CALCULATE_ACCRUED_INTEREST
                    message: The format for calculatingAccruedInterest is not valid.
                FORMAT_CUSTOMER_PAYMENT_INFORMATION:
                  description: |
                    The format of customerPaymentInformation is not valid.
                  value:
                    code: FORMAT_CUSTOMER_PAYMENT_INFORMATION
                    message: The format of customerPaymentInformation is not valid.
                FORMAT_FROM_DATE:
                  description: |
                    The format of the fromDate is not valid.
                  value:
                    code: FORMAT_FROM_DATE
                    message: The format of the fromDate is not valid.
                FORMAT_TO_DATE:
                  description: |
                    The format of toDate is not valid.
                  value:
                    code: FORMAT_TO_DATE
                    message: The format of toDate is not valid.
                FORMAT_REMOVE_PAYMENT_ON_ACCOUNT:
                  description: |
                    The format of removePOA is not valid.
                  value:
                    code: FORMAT_REMOVE_PAYMENT_ON_ACCOUNT
                    message: The format of removePOA is not valid.
                FORMAT_INCLUDE_ESTIMATED_CHARGES:
                  description: |
                    The format of includeEstimatedCharges is not valid
                  value:
                    code: FORMAT_INCLUDE_ESTIMATED_CHARGES
                    message: The format of includeEstimatedCharges is not valid
                RULE_INVALID_DATE_RANGE:
                  description: |
                    The provided date range is not valid.
                  value:
                    code: RULE_INVALID_DATE_RANGE
                    message: The provided date range is not valid.
                RULE_INCONSISTENT_QUERY_PARAMS:
                  description: |
                    Provide date range or docNumber when onlyOpenItems is false.
                  value:
                    code: RULE_INCONSISTENT_QUERY_PARAMS
                    message: Provide date range or docNumber when onlyOpenItems is
                      false.
                MISSING_TO_DATE:
                  description: |
                    The To date parameter is missing.
                  value:
                    code: MISSING_TO_DATE
                    message: The To date parameter is missing.
                MISSING_FROM_DATE:
                  description: |
                    The From date parameter is missing
                  value:
                    code: MISSING_FROM_DATE
                    message: The From date parameter is missing
                RANGE_TO_DATE_BEFORE_FROM_DATE:
                  description: |
                    The To date must be after the From date.
                  value:
                    code: RANGE_TO_DATE_BEFORE_FROM_DATE
                    message: The To date must be after the From date.
                RULE_INCORRECT_GOV_TEST_SCENARIO:
                  description: "The request did not match any available Sandbox data.\
                    \ Check that the supplied Gov-Test-Scenario is correct for \n\
                    this endpoint version. This error will only be returned in the\
                    \ Sandbox environment.\n"
                  value:
                    code: RULE_INCORRECT_GOV_TEST_SCENARIO
                    message: The supplied Gov-Test-Scenario is not valid
        "403":
          description: Forbidden
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                required:
                - code
                type: object
                properties:
                  code:
                    type: string
                    description: The error code
                  message:
                    type: string
                    description: The error message
                description: Error Response
              examples:
                CLIENT_OR_AGENT_NOT_AUTHORISED:
                  description: |
                    'The client or agent is not authorised. This is because: the client is not enrolled for MTD, the agent is not enrolled for Agent Services, the client has not authorised the agent to act on their behalf, or the Authorization token provided is not correct.'
                  value:
                    code: CLIENT_OR_AGENT_NOT_AUTHORISED
                    message: "The client or agent is not authorised. This is because:\
                      \ the client is not enrolled for MTD, the agent is not enrolled\
                      \ for Agent Services, the client has not authorised the agent\
                      \ to act on their behalf, or the Authorization token provided\
                      \ is not correct."
        "404":
          description: Not found
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                required:
                - code
                type: object
                properties:
                  code:
                    type: string
                    description: The error code
                  message:
                    type: string
                    description: The error message
                description: Error Response
              examples:
                NOT_FOUND:
                  description: |
                    Matching resource not found.
                  value:
                    code: MATCHING_RESOURCE_NOT_FOUND
                    message: Matching resource not found
      security:
      - User-Restricted:
        - read:self-assessment
  /accounts/self-assessment/{nino}/payments-and-allocations:
    get:
      tags:
      - Payments and Liabilities
      summary: List Self Assessment Payments & Allocation Details
      description: "This endpoint enables you to list the payments and allocation\
        \ details of one or more liabilities for a National insurance number.\n\n\
        ### Test data\nScenario simulation using Gov-Test-Scenario headers is only\
        \ available in the sandbox environment.\n\n| Header Value (Gov-Test-Scenario)\
        \ | Scenario                                                         |\n|----------------------------------|------------------------------------------------------------------|\n\
        | N/A - DEFAULT                    | Simulates success response.         \
        \                             |\n| NOT_FOUND                        | Simulates\
        \ the scenario where no data is found.                   |\n| INVALID_DATE_RANGE\
        \               | Simulates the scenario where the provided date range is\
        \ invalid. |    \n"
      parameters:
      - name: nino
        in: path
        description: |
          National Insurance number, in the format `AA999999A`.
        required: true
        schema:
          type: string
          example: TC663795B
      - name: fromDate
        in: query
        description: The inclusive start date of the period to filter payments. The
          maximum date range between fromDate and toDate should not exceed 732 days.
        required: false
        schema:
          type: string
          example: 2019-01-02
      - name: toDate
        in: query
        description: The inclusive end date of the period to filter payments. The
          maximum date range between fromDate and toDate should not exceed 732 days.
        required: false
        schema:
          type: string
          example: 2019-01-02
      - name: paymentLot
        in: query
        description: An identifier for the batch process that processed the pagexyment
          and assigned it to the taxpayer's account.
        required: false
        schema:
          type: string
          example: "081203010024"
      - name: paymentLotItem
        in: query
        description: An identifier for each payment within a payment lot. paymentLot
          and paymentLotItem together uniquely identify a payment.
        required: false
        schema:
          type: string
          example: "000001"
      - name: Accept
        in: header
        description: |
          Specifies the response format and the version of the API to be used.
        required: true
        schema:
          type: string
          enum:
          - application/vnd.hmrc.3.0+json
      - name: Authorization
        in: header
        description: |
          An OAuth 2.0 Bearer Token with the *read:self-assessment* scope.
        required: true
        schema:
          type: string
          example: Bearer bb7fed3fe10dd235a2ccda3d50fb
      - name: Gov-Test-Scenario
        in: header
        description: |
          Only in sandbox environment. See Test Data table for all header values.
        required: false
        schema:
          type: string
          example: "-"
      responses:
        "200":
          description: Success
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                required:
                - links
                - payments
                type: object
                properties:
                  payments:
                    type: array
                    description: An array containing payments made by the customer.
                    items:
                      required:
                      - allocations
                      type: object
                      properties:
                        paymentLot:
                          type: string
                          description: An identifier for the batch process that processed
                            the payment and assigned it to the taxpayer's account.
                          example: AB1023456789-000001
                        paymentLotItem:
                          type: string
                          description: An identifier for each payment within a payment
                            lot. paymentLot and paymentLotItem together uniquely identify
                            a payment.
                          example: "000001"
                        paymentReference:
                          type: string
                          description: A unique reference number associated with the
                            payment.
                          example: "000001700000001"
                        paymentAmount:
                          type: number
                          description: "The amount of the payment received into the\
                            \ account. \n\nThe value must be between -99999999999.99\
                            \ and 99999999999.99 up to 2 decimal places."
                          example: 10000.00
                        paymentMethod:
                          type: string
                          description: "The method used to make the payment. \n\n\
                            Must conform to the regular expression:\n^[0-9A-Za-z]{1,30}$"
                          example: "BACS, Payment by card"
                        transactionDate:
                          type: string
                          description: "The date the payment was received into the\
                            \ account in the format: YYYY-MM-DD"
                          example: 2018-04-05
                        allocations:
                          type: array
                          description: A list of charges which are allocated amounts
                            from the payment
                          items:
                            required:
                            - chargeReference
                            type: object
                            properties:
                              chargeReference:
                                type: string
                                description: A unique reference for the original charge
                                  that the payment was made against.
                                example: XM002610011595
                              periodKey:
                                type: string
                                description: |-
                                  The period key attributed to the charge.

                                  A four digit reference containing characters and numbers to identify the specific tax period.
                                example: 16RL
                              periodKeyDescription:
                                type: string
                                description: A description of the period key as a
                                  tax period.
                                example: 6th April 2020 to 5th April 2021
                              startDate:
                                type: string
                                description: The start date of the tax year for the
                                  charge in the format YYYY-MM-DD
                                example: 2018-04-06
                              endDate:
                                type: string
                                description: The end date of the tax year for the
                                  charge in the format YYYY-MM-DD
                                example: 2019-04-05
                              dueDate:
                                type: string
                                description: The date the charge must be paid by.
                                  Interest or penalties will be accrued after this
                                  date.
                                example: 2019-07-27
                              chargeDetail:
                                type: object
                                properties:
                                  documentId:
                                    type: string
                                    description: "Same as Document Number unless on\
                                      \ output there are no postings then the Form\
                                      \ Bundle number is returned. Must conform to\
                                      \ the regular expression: ^[0-9A-Za-z]{1,12}$"
                                    example: "1040000872"
                                  documentType:
                                    type: string
                                    description: A code to specify the document type
                                      of which this is a subitem.
                                    example: "3880"
                                  documentTypeDescription:
                                    type: string
                                    description: Description of the document type.
                                    example: Income Tax Estimate
                                  chargeType:
                                    type: string
                                    description: A code to specify the type of charge.
                                    example: "1005"
                                  chargeTypeDescription:
                                    type: string
                                    description: Description of the charge type.
                                    example: Income Tax Estimate -  ITSA
                              amount:
                                type: number
                                description: |-
                                  The original value of this transaction.

                                  The value must be between -99999999999.99 and 99999999999.99 up to 2 decimal places.
                                example: 600.00
                              clearedAmount:
                                type: number
                                description: |-
                                  The cleared value of this transaction.

                                  The value must be between -99999999999.99 and 99999999999.99 up to 2 decimal places.
                                example: 600.00
                              contractAccount:
                                type: string
                                description: The accounting record for a particular
                                  charge type.
                                example: "000404772537"
                  links:
                    type: array
                    items:
                      required:
                      - href
                      - method
                      - rel
                      type: object
                      properties:
                        method:
                          type: string
                          description: The HTTP method type for the endpoint.
                          enum:
                          - GET
                        rel:
                          type: string
                          description: "A label for the endpoint, which describes\
                            \ how it is related to the current resource. The rel\
                            \ will be self where the action is retrieval of the\
                            \ same resource."
                          enum:
                          - self
                        href:
                          type: string
                          description: The relative URL of the endpoint.
                          example: /accounts/self-assessment/AA999999A/payments-and-allocations
              examples:
                Request:
                  value:
                    $ref: examples/listSelfAssessmentPaymentsAndAllocationDetails/def1/response.json
        "400":
          description: Bad request
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                required:
                - code
                type: object
                properties:
                  code:
                    type: string
                    description: The error code
                  message:
                    type: string
                    description: The error message
                description: Error Response
              examples:
                FORMAT_NINO:
                  description: |
                    The format of the supplied nino value is invalid.
                  value:
                    code: FORMAT_NINO
                    message: The format of the supplied nino value is invalid.
                FORMAT_FROM_DATE:
                  description: |
                    The format of the fromDate is not valid.
                  value:
                    code: FORMAT_FROM_DATE
                    message: The format of the fromDate is not valid.
                FORMAT_TO_DATE:
                  description: |
                    The format of toDate is not valid.
                  value:
                    code: FORMAT_TO_DATE
                    message: The format of toDate is not valid.
                RANGE_TO_DATE_BEFORE_FROM_DATE:
                  description: |
                    The To date must be after the From date.
                  value:
                    code: RANGE_TO_DATE_BEFORE_FROM_DATE
                    message: The To date must be after the From date.
                RULE_INVALID_DATE_RANGE:
                  description: |
                    The provided date range is not valid.
                  value:
                    code: RULE_INVALID_DATE_RANGE
                    message: The provided date range is not valid.
                MISSING_TO_DATE:
                  description: |
                    The To date parameter is missing.
                  value:
                    code: MISSING_TO_DATE
                    message: The To date parameter is missing.
                MISSING_FROM_DATE:
                  description: |
                    The From date parameter is missing
                  value:
                    code: MISSING_FROM_DATE
                    message: The From date parameter is missing
                RULE_INCONSISTENT_QUERY_PARAMS:
                  description: |
                    Provide either paymentLot & paymentLotItem or fromDate & toDate.
                  value:
                    code: RULE_INCONSISTENT_QUERY_PARAMS
                    message: Provide either paymentLot & paymentLotItem or fromDate
                      & toDate.
                FORMAT_PAYMENT_LOT:
                  description: |
                    The format of the supplied paymentLot value is not valid.
                  value:
                    code: FORMAT_PAYMENT_LOT
                    message: The format of the supplied paymentLot value is not valid.
                FORMAT_PAYMENT_LOT_ITEM:
                  description: |
                    The format of the supplied paymentLotItem value is not valid.
                  value:
                    code: FORMAT_PAYMENT_LOT_ITEM
                    message: The format of the supplied paymentLotItem value is not
                      valid.
                MISSING_PAYMENT_LOT:
                  description: |
                    The paymentLotItem value has been provided, but paymentLot value is missing.
                  value:
                    code: MISSING_PAYMENT_LOT
                    message: "The paymentLotItem value has been provided, but paymentLot\
                      \ value is missing."
                MISSING_PAYMENT_LOT_ITEM:
                  description: |
                    The paymentLot value has been provided, but the paymentLotItem value is missing.
                  value:
                    code: MISSING_PAYMENT_LOT_ITEM
                    message: "The paymentLot value has been provided, but the paymentLotItem\
                      \ value is missing."
                RULE_INCORRECT_GOV_TEST_SCENARIO:
                  description: "The request did not match any available Sandbox data.\
                    \ Check that the supplied Gov-Test-Scenario is correct for \n\
                    this endpoint version. This error will only be returned in the\
                    \ Sandbox environment.\n"
                  value:
                    code: RULE_INCORRECT_GOV_TEST_SCENARIO
                    message: The supplied Gov-Test-Scenario is not valid
        "403":
          description: Forbidden
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                required:
                - code
                type: object
                properties:
                  code:
                    type: string
                    description: The error code
                  message:
                    type: string
                    description: The error message
                description: Error Response
              examples:
                CLIENT_OR_AGENT_NOT_AUTHORISED:
                  description: |
                    'The client or agent is not authorised. This is because: the client is not enrolled for MTD, the agent is not enrolled for Agent Services, the client has not authorised the agent to act on their behalf, or the Authorization token provided is not correct.'
                  value:
                    code: CLIENT_OR_AGENT_NOT_AUTHORISED
                    message: "The client or agent is not authorised. This is because:\
                      \ the client is not enrolled for MTD, the agent is not enrolled\
                      \ for Agent Services, the client has not authorised the agent\
                      \ to act on their behalf, or the Authorization token provided\
                      \ is not correct."
        "404":
          description: Not found
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                required:
                - code
                type: object
                properties:
                  code:
                    type: string
                    description: The error code
                  message:
                    type: string
                    description: The error message
                description: Error Response
              examples:
                NOT_FOUND:
                  description: |
                    Matching resource not found.
                  value:
                    code: MATCHING_RESOURCE_NOT_FOUND
                    message: Matching resource not found
      security:
      - User-Restricted:
        - read:self-assessment
  /accounts/self-assessment/{nino}/{taxYear}/collection/tax-code:
    get:
      summary: Retrieve Coding Out Underpayments and Debt Amounts
      parameters:
      - name: source
        in: query
        description: |
          Specifies the source of data to be returned. If source is not provided, the latest values will be returned.<p> Limited to the following possible values: <ul><li>`hmrcHeld`<li>`user`<li>`latest`</p>
        required: false
        schema:
          type: string
      security:
      - User-Restricted:
        - read:self-assessment
    put:
      summary: Create or Amend Coding Out Underpayments and Debt Amounts
      security:
      - User-Restricted:
        - write:self-assessment
    delete:
      summary: Delete Coding Out Underpayments and Debt Amounts
      security:
      - User-Restricted:
        - write:self-assessment
  /accounts/self-assessment/{nino}/{taxYear}/collection/tax-code/coding-out/opt-out:
    post:
      tags:
      - Coding Out Status
      summary: Opt Out of Coding Out
      description: "This endpoint enables a specified customer (identified by a National\
        \ Insurance number) and tax year to opt out of coding out. Opt-out status\
        \ can be changed up to and including 30 December following the end of the\
        \ specified tax year. Opt-out status cannot be changed after the customer\
        \ has made a final declaration for the specified tax year.\n    \n### Test\
        \ data\nScenario simulation using Gov-Test-Scenario headers is only available\
        \ in the sandbox environment.\n\n| Header Value (Gov-Test-Scenario) | Scenario\
        \                                                                        \
        \                                                                        \
        \ |\n|----------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|\n\
        | N/A - DEFAULT                    | Simulates a successful response with\
        \ latest values.                                                         \
        \                                             |\n| BUSINESS_PARTNER_NOT_EXIST\
        \       | Simulates a scenario where the NINO is valid but is not registered\
        \ with ITSD as a business partner.                                       \
        \               |\n| ITSA_CONTRACT_OBJECT_NOT_EXIST   | Simulates a scenario\
        \ where the NINO is valid and is registered with ITSD as a business partner,\
        \ but the ITSA contract object does not exist for the NINO.|\n| ALREADY_OPTED_OUT\
        \                | Simulates a scenario where the customer cannot be opted\
        \ out because they are already opted out.                                \
        \                          |\n| STATEFUL                         | Performs\
        \ a stateful Opt Out of Coding Out.                                      \
        \                                                                        \
        \ |\n"
      parameters:
      - name: Accept
        in: header
        description: |
          Specifies the response format and the version of the API to be used.
        required: true
        schema:
          type: string
          enum:
          - application/vnd.hmrc.3.0+json
      - name: Authorization
        in: header
        description: |
          An OAuth 2.0 Bearer Token with the *read:self-assessment* scope.
        required: true
        schema:
          type: string
          example: Bearer bb7fed3fe10dd235a2ccda3d50fb
      - name: Gov-Test-Scenario
        in: header
        description: |
          Only in sandbox environment. See Test Data table for all header values.
        required: false
        schema:
          type: string
          example: "-"
      - name: nino
        in: path
        description: |
          National Insurance number, in the format `AA999999A`.
        required: true
        schema:
          type: string
          example: TC663795B
      - name: taxYear
        in: path
        description: |
          The tax year the data applies to, for example, 2021-22. The start year and end year must not span two tax years. No gaps are allowed, for example, 2020-22 is not valid.
        required: true
        schema:
          type: string
          example: 2021-22
      responses:
        "204":
          description: Success
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
        "400":
          description: Bad request
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                required:
                - code
                type: object
                properties:
                  code:
                    type: string
                    description: The error code
                  message:
                    type: string
                    description: The error message
                description: Error Response
              examples:
                FORMAT_NINO:
                  description: |
                    The format of the supplied nino value is invalid.
                  value:
                    code: FORMAT_NINO
                    message: The format of the supplied nino value is invalid.
                FORMAT_TAX_YEAR:
                  description: |
                    The format of the supplied taxYear value is invalid.
                  value:
                    code: FORMAT_TAX_YEAR
                    message: The format of the supplied taxYear value is invalid.
                RULE_BUSINESS_PARTNER_NOT_EXIST:
                  description: |
                    The remote endpoint has indicated that business partner does not exist for NINO.
                  value:
                    code: RULE_BUSINESS_PARTNER_NOT_EXIST
                    message: Provided NINO is not registered as business partner.
                RULE_ITSA_CONTRACT_OBJECT_NOT_EXIST:
                  description: |
                    The remote endpoint has indicated that ITSA contract object does not exist.
                  value:
                    code: RULE_ITSA_CONTRACT_OBJECT_NOT_EXIST
                    message: ITSA contract object does not exist.
                RULE_ALREADY_OPTED_OUT:
                  description: |
                    The opt-out indicator cannot be set to the same value it currently holds.
                  value:
                    code: RULE_ALREADY_OPTED_OUT
                    message: Customer is already opted out of coding out
                RULE_INCORRECT_GOV_TEST_SCENARIO:
                  description: "The request did not match any available Sandbox data.\
                    \ Check that the supplied Gov-Test-Scenario is correct for \n\
                    this endpoint version. This error will only be returned in the\
                    \ Sandbox environment.\n"
                  value:
                    code: RULE_INCORRECT_GOV_TEST_SCENARIO
                    message: The supplied Gov-Test-Scenario is not valid
        "403":
          description: Forbidden
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                required:
                - code
                type: object
                properties:
                  code:
                    type: string
                    description: The error code
                  message:
                    type: string
                    description: The error message
                description: Error Response
              examples:
                CLIENT_OR_AGENT_NOT_AUTHORISED:
                  description: |
                    'The client or agent is not authorised. This is because: the client is not enrolled for MTD, the agent is not enrolled for Agent Services, the client has not authorised the agent to act on their behalf, or the Authorization token provided is not correct.'
                  value:
                    code: CLIENT_OR_AGENT_NOT_AUTHORISED
                    message: "The client or agent is not authorised. This is because:\
                      \ the client is not enrolled for MTD, the agent is not enrolled\
                      \ for Agent Services, the client has not authorised the agent\
                      \ to act on their behalf, or the Authorization token provided\
                      \ is not correct."
      security:
      - User-Restricted:
        - read:self-assessment
  /accounts/self-assessment/{nino}/{taxYear}/collection/tax-code/coding-out/status:
    get:
      tags:
      - Coding Out Status
      summary: Retrieve Coding Out Status
      description: |
        This endpoint enables you to retrieve opt-out of coding out status for a specified customer (identified by a National Insurance number) and tax year.

        ### Test data
        Scenario simulation using Gov-Test-Scenario headers is only available in the sandbox environment.

        | Header Value (Gov-Test-Scenario)        | Scenario                                                           |
        |-----------------------------------------|--------------------------------------------------------------------|
        | N/A - DEFAULT                           | Simulates a successful response with latest values.                |
        | BUSINESS_PARTNER_NOT_EXIST              | Simulates a scenario where the business partner does not exist.    |
        | ITSA_CONTRACT_OBJECT_NOT_EXIST          | Simulates a scenario where the ITSA contract object does not exist.|
        | STATEFUL                                | Performs a stateful Retrieve Coding Out Status.                    |
      parameters:
      - name: Accept
        in: header
        description: |
          Specifies the response format and the version of the API to be used.
        required: true
        schema:
          type: string
          enum:
          - application/vnd.hmrc.3.0+json
      - name: Authorization
        in: header
        description: |
          An OAuth 2.0 Bearer Token with the *read:self-assessment* scope.
        required: true
        schema:
          type: string
          example: Bearer bb7fed3fe10dd235a2ccda3d50fb
      - name: Gov-Test-Scenario
        in: header
        description: |
          Only in sandbox environment. See Test Data table for all header values.
        required: false
        schema:
          type: string
          example: "-"
      - name: nino
        in: path
        description: |
          National Insurance number, in the format `AA999999A`.
        required: true
        schema:
          type: string
          example: TC663795B
      - name: taxYear
        in: path
        description: |
          The tax year the data applies to, for example, 2021-22. The start year and end year must not span two tax years. No gaps are allowed, for example, 2020-22 is not valid.
        required: true
        schema:
          type: string
          example: 2021-22
      responses:
        "200":
          description: Success
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                required:
                - nino
                - optOutIndicator
                - processingDate
                - taxYear
                type: object
                properties:
                  processingDate:
                    type: string
                    description: The date and time that the request was processed
                      in the system.
                    format: date-time
                  nino:
                    type: string
                    description: "National Insurance number, in the format AA999999A."
                  taxYear:
                    pattern: "^2[0-9]{3}-[0-9]{2}$"
                    type: string
                    description: "The tax year the data applies to, for example 2021-22.\
                      \ The start year and end year must not span two tax years. The\
                      \ minimum tax year is 2021-22. No gaps are allowed, for example,\
                      \ 2020-22 is not valid. (The minimum tax year in Sandbox is\
                      \ 2019-20.)."
                  optOutIndicator:
                    type: boolean
                    description: |-
                      Indicates the coding out status of the tax year.
                      - true: Customer opted out of coding out for the tax year
                      - false: Customer opted in to coding out for the tax year
                additionalProperties: false
              examples:
                Request:
                  value:
                    $ref: ./examples/retrieveCodingOutStatus/def1/response.json
        "400":
          description: Bad request
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                required:
                - code
                type: object
                properties:
                  code:
                    type: string
                    description: The error code
                  message:
                    type: string
                    description: The error message
                description: Error Response
              examples:
                FORMAT_NINO:
                  description: |
                    The format of the supplied nino value is invalid.
                  value:
                    code: FORMAT_NINO
                    message: The format of the supplied nino value is invalid.
                FORMAT_TAX_YEAR:
                  description: |
                    The format of the supplied taxYear value is invalid.
                  value:
                    code: FORMAT_TAX_YEAR
                    message: The format of the supplied taxYear value is invalid.
                RULE_TAX_YEAR_NOT_SUPPORTED:
                  description: |
                    The specified tax year is not supported. That is, the tax year specified is before the minimum tax year value.
                  value:
                    code: RULE_TAX_YEAR_NOT_SUPPORTED
                    message: "The specified tax year is not supported. Either the\
                      \ tax year specified is before the minimum tax year value, or\
                      \ it is after the maximum tax year value."
                RULE_TAX_YEAR_RANGE_INVALID:
                  description: |
                    A taxYear range of one year is required.
                  value:
                    code: RULE_TAX_YEAR_RANGE_INVALID
                    message: A taxYear range of one year is required.
                RULE_BUSINESS_PARTNER_NOT_EXIST:
                  description: |
                    The remote endpoint has indicated that business partner does not exist for NINO.
                  value:
                    code: RULE_BUSINESS_PARTNER_NOT_EXIST
                    message: Provided NINO is not registered as business partner.
                RULE_ITSA_CONTRACT_OBJECT_NOT_EXIST:
                  description: |
                    The remote endpoint has indicated that ITSA contract object does not exist.
                  value:
                    code: RULE_ITSA_CONTRACT_OBJECT_NOT_EXIST
                    message: ITSA contract object does not exist.
                RULE_INCORRECT_GOV_TEST_SCENARIO:
                  description: "The request did not match any available Sandbox data.\
                    \ Check that the supplied Gov-Test-Scenario is correct for \n\
                    this endpoint version. This error will only be returned in the\
                    \ Sandbox environment.\n"
                  value:
                    code: RULE_INCORRECT_GOV_TEST_SCENARIO
                    message: The supplied Gov-Test-Scenario is not valid
      security:
      - User-Restricted:
        - read:self-assessment
  /accounts/self-assessment/{nino}/{taxYear}/collection/tax-code/coding-out/opt-in:
    post:
      tags:
      - Coding Out Status
      summary: Opt In to Coding Out
      description: |
        This endpoint enables a specified customer (identified by a National Insurance number) and tax year to opt in to coding out.

        ### Test data
        Scenario simulation using Gov-Test-Scenario headers is only available in the sandbox environment.

        | Header Value (Gov-Test-Scenario) | Scenario                                                                                                                                                 |
        |----------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|
        | N/A - DEFAULT                    | Simulates a successful response with latest values.                                                                                                      |
        | BUSINESS_PARTNER_NOT_EXIST       | Simulates a scenario where the NINO is valid but is not registered with ITSD as a business partner.                                                      |
        | ITSA_CONTRACT_OBJECT_NOT_EXIST   | Simulates a scenario where the NINO is valid and is registered with ITSD as a business partner, but the ITSA contract object does not exist for the NINO.|
        | ALREADY_OPTED_IN                 | Simulates a scenario where the customer cannot be opted in because they are already opted in.                                                            |
        | STATEFUL                         | Performs a stateful Opt In to Coding Out.                                                                                                                |
      parameters:
      - name: Accept
        in: header
        description: |
          Specifies the response format and the version of the API to be used.
        required: true
        schema:
          type: string
          enum:
          - application/vnd.hmrc.3.0+json
      - name: Authorization
        in: header
        description: |
          An OAuth 2.0 Bearer Token with the *read:self-assessment* scope.
        required: true
        schema:
          type: string
          example: Bearer bb7fed3fe10dd235a2ccda3d50fb
      - name: Gov-Test-Scenario
        in: header
        description: |
          Only in sandbox environment. See Test Data table for all header values.
        required: false
        schema:
          type: string
          example: "-"
      - name: nino
        in: path
        description: |
          National Insurance number, in the format `AA999999A`.
        required: true
        schema:
          type: string
          example: TC663795B
      - name: taxYear
        in: path
        description: |
          The tax year the data applies to, for example, 2021-22. The start year and end year must not span two tax years. No gaps are allowed, for example, 2020-22 is not valid.
        required: true
        schema:
          type: string
          example: 2021-22
      responses:
        "204":
          description: Success
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
        "400":
          description: Bad request
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                required:
                - code
                type: object
                properties:
                  code:
                    type: string
                    description: The error code
                  message:
                    type: string
                    description: The error message
                description: Error Response
              examples:
                FORMAT_NINO:
                  description: |
                    The format of the supplied nino value is invalid.
                  value:
                    code: FORMAT_NINO
                    message: The format of the supplied nino value is invalid.
                FORMAT_TAX_YEAR:
                  description: |
                    The format of the supplied taxYear value is invalid.
                  value:
                    code: FORMAT_TAX_YEAR
                    message: The format of the supplied taxYear value is invalid.
                RULE_BUSINESS_PARTNER_NOT_EXIST:
                  description: |
                    The remote endpoint has indicated that business partner does not exist for NINO.
                  value:
                    code: RULE_BUSINESS_PARTNER_NOT_EXIST
                    message: Provided NINO is not registered as business partner.
                RULE_ITSA_CONTRACT_OBJECT_NOT_EXIST:
                  description: |
                    The remote endpoint has indicated that ITSA contract object does not exist.
                  value:
                    code: RULE_ITSA_CONTRACT_OBJECT_NOT_EXIST
                    message: ITSA contract object does not exist.
                RULE_ALREADY_OPTED_IN:
                  description: |
                    The remote endpoint has indicated that customer is already opted in to coding out.
                  value:
                    code: RULE_ALREADY_OPTED_IN
                    message: Customer is already opted in to coding out
                RULE_INCORRECT_GOV_TEST_SCENARIO:
                  description: "The request did not match any available Sandbox data.\
                    \ Check that the supplied Gov-Test-Scenario is correct for \n\
                    this endpoint version. This error will only be returned in the\
                    \ Sandbox environment.\n"
                  value:
                    code: RULE_INCORRECT_GOV_TEST_SCENARIO
                    message: The supplied Gov-Test-Scenario is not valid
        "403":
          description: Forbidden
          headers:
            X-CorrelationId:
              description: |
                Unique ID for operation tracking
                String, 36 characters.
              required: true
              schema:
                type: string
                example: c75f40a6-a3df-4429-a697-471eeec46435
            Deprecation:
              description: |
                The deprecation date/time for this endpoint.
              required: false
              schema:
                type: string
                example: "Sun, 01 Jan 2023 23:59:59 GMT"
            Sunset:
              description: |
                The earliest date/time this endpoint will become unavailable after deprecation.
              required: false
              schema:
                type: string
                example: "Sun, 02 Jul 2023 23:59:59 GMT"
            Link:
              description: |
                URL of the documentation for the API.
              required: false
              schema:
                type: string
                example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
          content:
            application/json:
              schema:
                required:
                - code
                type: object
                properties:
                  code:
                    type: string
                    description: The error code
                  message:
                    type: string
                    description: The error message
                description: Error Response
              examples:
                CLIENT_OR_AGENT_NOT_AUTHORISED:
                  description: |
                    'The client or agent is not authorised. This is because: the client is not enrolled for MTD, the agent is not enrolled for Agent Services, the client has not authorised the agent to act on their behalf, or the Authorization token provided is not correct.'
                  value:
                    code: CLIENT_OR_AGENT_NOT_AUTHORISED
                    message: "The client or agent is not authorised. This is because:\
                      \ the client is not enrolled for MTD, the agent is not enrolled\
                      \ for Agent Services, the client has not authorised the agent\
                      \ to act on their behalf, or the Authorization token provided\
                      \ is not correct."
      security:
      - User-Restricted:
        - read:self-assessment
components:
  schemas:
    response:
      title: Retrieve History of a Self Assessment Charge
      required:
      - chargeHistoryDetails
      type: object
      properties:
        chargeHistoryDetails:
          type: array
          description: A list of changes to a particular charge
          items:
            title: changeDetails
            required:
            - changeDate
            - changeReason
            - changeTimestamp
            - description
            - totalAmount
            - transactionDate
            - transactionId
            type: object
            properties:
              taxYear:
                type: string
                description: "The tax year that this charge relates to in the format:\
                  \ YYYY-YY."
                example: 2022-23
              transactionId:
                type: string
                description: "A unique identifier used to return a single charge.\
                  \ Must conform to the regular expression ^[A-Za-z0-9]{1,12}$"
                example: X123456790A
              transactionDate:
                type: string
                description: "The date the charge was created in the format: YYYY-MM-DD."
                example: 2018-04-05
              description:
                type: string
                description: Primary method to identify what type of charge has been
                  called.
                example: "POA1, Balancing charge"
              totalAmount:
                multipleOf: 0.01
                maximum: 99999999999.99
                minimum: -99999999999.99
                type: number
                description: The value of the charge following the change. The value
                  must be between -99999999999.99 and 99999999999.99 up to 2 decimal
                  places.
                example: 600.00
              changeDate:
                type: string
                description: "The date the charge was changed, in the format: YYYY-MM-DD.\
                  \ This field is deprecated and will be removed in a future release.\
                  \ Use changeTimestamp instead."
                format: date
                example: 2018-04-05
                deprecated: true
              changeTimestamp:
                type: string
                description: "[Test only] The timestamp the charge was changed, in\
                  \ the format: YYYY-MM-DDThh:mm:ss.SSSZ"
                format: date-time
                example: 2018-04-05T14:15:22.802Z
              changeReason:
                type: string
                description: The reason for the change.
                example: " Amended return, Customer Request"
              poaAdjustmentReason:
                type: string
                description: "A numeric code indicating the reason for adjustment\
                  \ to Payments on Account. \n\nThe possible values (with their meanings)\
                  \ are:\n\n001: Profits for the business are down/the business has\
                  \ ceased\n\n002: Other income has gone down\n\n003: Tax Allowances\
                  \ and reliefs have gone up\n\n004: Tax deducted at source is more\
                  \ than previous year\n\n005: Increasing the PoA after a prior adjustment\n\
                  \nFor example: 004"
                example: "004"
      description: This endpoint enables you to retrieve the history of changes to
        a single charge made by HMRC. A National Insurance number and transaction
        ID must be provided.
    error-response:
      required:
      - code
      type: object
      properties:
        code:
          type: string
          description: The error code
        message:
          type: string
          description: The error message
      description: Error Response
    response_1:
      title: Retrieve Self Assessment Balance and Transactions
      required:
      - balanceDetails
      type: object
      properties:
        balanceDetails:
          required:
          - bcdBalancePerYear
          - overdueAmount
          - payableAmount
          - pendingChargeDueAmount
          - totalBalance
          type: object
          properties:
            payableAmount:
              type: number
              description: The sum of any non-zero charges whose payment due date
                is within 30 days. The value must be between -99999999999.99 and 99999999999.99
                to 2 decimal places.
              example: 5009.99
            payableDueDate:
              type: string
              description: Next payment date for charges due in the format YYYY-MM-DD.
              example: 2018-04-05
            pendingChargeDueAmount:
              type: number
              description: The sum of any charges whose payment is pending (not yet
                due). The value must be between -99999999999.99 and 99999999999.99
                to 2 decimal places.
              example: 5009.99
            pendingChargeDueDate:
              type: string
              description: The date by when the next pending (not yet due) charge
                must be paid in the format YYYY-MM-DD.
              example: 2018-04-05
            overdueAmount:
              type: number
              description: "The total amount of charges under each documentID whose\
                \ due date is in the past Accrued Interest Amount / LPI Amount will\
                \ also be included (where applicable). \r\n The value must be between\
                \ -99999999999.99 and 99999999999.99 to 2 decimal places."
              example: 5009.99
            bcdBalancePerYear:
              type: array
              description: An array containing balance charge debit payment details.
              items:
                required:
                - bcdAmount
                - taxYear
                type: object
                properties:
                  taxYear:
                    type: string
                    description: The tax year for the appropriate balance charge debit.
                    example: 2018-19
                  bcdAmount:
                    type: number
                    description: "The balancing charge debit amount is the balancing\
                      \ payment due by the taxpayer calculated when the return is\
                      \ captured.\r\nThe value must be between -99999999999.99 and\
                      \ 99999999999.99 to 2 decimal places."
                    example: 5009.99
            earliestPaymentDateOverdue:
              type: string
              description: The next day after the payment due date in the format YYYY-MM-DD
              example: 2018-04-05
            totalBalance:
              type: number
              description: "The sum of all the unpaid charges excluding statistical\
                \ and  EOY coded out. The total balance should be equal to the sum\
                \ of the balance due within 30 days, balance not due in 30 days, and\
                \ overdue amount.\r\nThe value must be between -99999999999.99 and\
                \ 99999999999.99 to 2 decimal places."
              example: 5009.99
            amountCodedOut:
              type: number
              description: "The total amount of underpayment codeout.\r\nThe value\
                \ must be between -99999999999.99 and 99999999999.99 to 2 decimal\
                \ places."
              example: 5009.99
            totalBcdBalance:
              type: number
              description: "The total of the Balance charge debit balance amount.\r\
                \nThe value must be between -99999999999.99 and 99999999999.99 to\
                \ 2 decimal places"
              example: 5009.99
            unallocatedCredit:
              type: number
              description: "Sum of all the Open credit Items on the customer's account,\
                \ posted for Income tax Self-assessment.\r\nThe value must be between\
                \ -99999999999.99 and 99999999999.99 to 2 decimal places."
              example: 5009.99
            allocatedCredit:
              type: number
              description: "Sum of all the closed credit items on the customer's account,\
                \ posted for  Income tax Self-assessment.\r\nThe value must be between\
                \ -99999999999.99 and 99999999999.99 to 2 decimal places."
              example: 5009.99
            totalCredit:
              type: number
              description: "Sum of unallocated credit + allocated credit.\r\nThe value\
                \ must be between -99999999999.99 and 99999999999.99 to 2 decimal\
                \ places."
              example: 5009.99
            firstPendingAmountRequested:
              type: number
              description: "This will be the first pending amount that is requested.\r\
                \nThe value must be between -99999999999.99 and 99999999999.99 to\
                \ 2 decimal places."
              example: 5009.99
            secondPendingAmountRequested:
              type: number
              description: "This will be the second pending amount that is requested.\r\
                \nThe value must be between -99999999999.99 and 99999999999.99 to\
                \ 2 decimal places."
              example: 5009.99
            availableCredit:
              type: number
              description: "This will be equal to total credit minus the pending amount(s)\
                \ requested.\r\nThe value must be between -99999999999.99 and 99999999999.99\
                \ to 2 decimal places."
              example: 5009.99
        codingDetails:
          title: Retrieve coding details
          type: array
          description: An Object containing coding details
          items:
            type: object
            properties:
              returnTaxYear:
                type: string
                description: The ending year of the tax year to which the return relates
                  is in the format YYYY-YY.
                example: 2021-22
              totalLiabilityAmount:
                multipleOf: 0.01
                maximum: 99999999999.99
                minimum: -99999999999.99
                type: number
                description: The total amount of the Self Assessment tax return inclusive
                  of coded charges. The value must be between -99999999999.99 and
                  99999999999.99 up to 2 decimal places.
                example: 5009.99
              codingTaxYear:
                type: string
                description: The tax year that the coded out charge will be attached
                  to.
                example: 2021-22
              coded:
                type: object
                properties:
                  charge:
                    multipleOf: 0.01
                    maximum: 99999999999.99
                    minimum: -99999999999.99
                    type: number
                    description: The coded out charge. The value must be between -99999999999.99
                      and 99999999999.99 up to 2 decimal places.
                    example: 5009.99
                  initiationDate:
                    type: string
                    description: "Initiation date of the coded out charge, in the\
                      \ format YYYY-MM-DD."
                    example: 2021-04-05
                description: An object containing a coded amount and initiation date
        documentDetails:
          type: array
          description: An array containing document details
          items:
            required:
            - documentDate
            - documentId
            - isChargeEstimate
            - isCodedOut
            - originalAmount
            - outstandingAmount
            type: object
            properties:
              taxYear:
                type: string
                description: "The tax year of the Document (Billing period from \
                  \ billing period to), in the format YYYY-YY. For example, the tax\
                  \ year 2020 to 2021 is expressed as 2020-21."
                example: 2020-21
              documentId:
                type: string
                description: "DocumentID may contain SAP document number or Form Bundle\
                  \ Number for zero-amount documents. Must conform to the regular\
                  \ expression ^[0-9a-zA-Z]{1,12}$"
                example: "1455"
              formBundleNumber:
                type: string
                description: 'The form bundle number designates a package of related
                  transactions gathered together. '
                example: "88888888"
              creditReason:
                type: string
                description: Credit Reason gives the reason as to why there is a credit
                  on the account.
                example: Voluntary Payment
                enum:
                - Voluntary Payment
                - Income tax Self Assessment Return
                - Excess Payment
              documentDate:
                type: string
                description: The date when the document for a particular tax group
                  containing charges was created in the format YYYY-MM-DD.
                example: 2018-04-05
              documentText:
                type: string
                description: Provides details about the tax group that the charge
                  belongs to.
                example: ITSA- Bal Charge
              documentDueDate:
                type: string
                description: The date the item must be received in the format YYYY-MM-DD.
                example: 2021-04-05
              documentDescription:
                type: string
                description: The primary method to identify what type of document
                  has been called.
                example: ITSA- POA 1
                enum:
                - ITSA- POA 1
                - ITSA - POA 2
                - ITSA- Bal Charge
                - New Charge
                - Clearing Document
                - TRM New Charge
                - TRM Amend Charge
                - Payment
                - Repayment
              originalAmount:
                multipleOf: 0.01
                maximum: 99999999999.99
                minimum: -99999999999.99
                type: number
                description: "The original value of this transaction before payments,\
                  \ credits, or adjustments.\r\nThe value must be between -99999999999.99\
                  \ and 99999999999.99 to 2 decimal places."
                example: 5000.99
              outstandingAmount:
                multipleOf: 0.01
                maximum: 99999999999.99
                minimum: -99999999999.99
                type: number
                description: "The amount remaining of this transaction after payments,\
                  \ credits, or adjustments.\r\nThe value must be between -99999999999.99\
                  \ and 99999999999.99 to 2 decimal places."
                example: 5000.99
              lastClearing:
                type: object
                properties:
                  lastClearingDate:
                    type: string
                    description: "The date the outstanding amount was last modified,\
                      \ in the format YYYY-MM-DD."
                    example: 2018-04-05
                  lastClearingReason:
                    type: string
                    description: "The reason for the change. For example, an interest\
                      \ charge was created."
                    example: Incoming Payment
                    enum:
                    - Incoming Payment
                    - Outgoing Payment
                    - Other
                    - Write-Off
                    - Reversal
                  lastClearedAmount:
                    multipleOf: 0.01
                    maximum: 99999999999.99
                    minimum: -99999999999.99
                    type: number
                    description: The amount the transaction was last modified by.
                      The value must be between -99999999999.99 and 99999999999.99
                      to 2 decimal places.
                    example: 5000.99
                description: Details if the amount was previously modified.
              isChargeEstimate:
                type: boolean
                description: An indicator to represent that the charge is an estimate
                  and not an actual charge. The value must be true or false.
                example: false
              isCodedOut:
                type: boolean
                description: An indicator to represent that the charge has been sent
                  for coding out.
                example: false
              paymentLot:
                type: string
                description: A unique identifier for a credit that has been made direct
                  to ETMP.
                example: AB1023456789
              paymentLotItem:
                type: string
                description: A unique ID that is used in combination with Payment
                  Lot to refer to an individual payment.
                example: "000001"
              effectiveDateOfPayment:
                type: string
                description: The effective date of payment in the format YYYY-MM-DD.
                example: 2021-04-05
              latePaymentInterest:
                type: object
                properties:
                  latePaymentInterestId:
                    type: string
                    description: Late Payment Interest ID is the Charge Reference
                      Number of all the monthly and final interest charges of the
                      same parent charge.
                    example: "1234567890123456"
                  accruingInterestAmount:
                    multipleOf: 0.01
                    maximum: 99999999999.99
                    minimum: -99999999999.99
                    type: number
                    description: "The total value of all the monthly interest charges\
                      \ and accruing (unposted) interest charges is grouped by Charge\
                      \ Reference level. \r\nThe value must be between -99999999999.99\
                      \ and 99999999999.99 to 2 decimal places.\r\n"
                    example: 5000.99
                  interestRate:
                    multipleOf: 0.01
                    maximum: 99.99
                    minimum: 0
                    type: number
                    description: The latest interest rate for late payments. The value
                      must be between 0 and 99.99 to 2 decimal places.
                    example: 5.99
                  interestStartDate:
                    type: string
                    description: The date the interest charges started in the format
                      YYYY-MM-DD.
                    example: 2020-04-05
                  interestEndDate:
                    type: string
                    description: The date the interest charges ended in the format
                      YYYY-MM-DD.
                    example: 2020-05-05
                  interestAmount:
                    multipleOf: 0.01
                    maximum: 99999999999.99
                    minimum: -99999999999.99
                    type: number
                    description: "The total value of all the monthly interest charges\
                      \ and final interest charges is grouped by Charge Reference\
                      \ level.\r\nThe value must be between -99999999999.99 and 99999999999.99\
                      \ to 2 decimal places."
                    example: 201.99
                  interestDunningLockAmount:
                    multipleOf: 0.01
                    maximum: 99999999999.99
                    minimum: -99999999999.99
                    type: number
                    description: "Late payment interest amount where the  Interest\
                      \ is temporarily not being charged on (A lock has been put so\
                      \ the interest will not be charged to the customer). \r\nThe\
                      \ value must be between -99999999999.99 and 99999999999.99 to\
                      \ 2 decimal places."
                    example: 5009.99
                  interestOutstandingAmount:
                    multipleOf: 0.01
                    maximum: 99999999999.99
                    minimum: -99999999999.99
                    type: number
                    description: "TThe unpaid amount of Accruing Interest or Late\
                      \ Payment Interest. \r\nThe value must be between -99999999999.99\
                      \ and 99999999999.99 to 2 decimal places."
                    example: 5000.99
                description: An object containing late payment interest details.
              amountCodedOut:
                multipleOf: 0.01
                maximum: 99999999999.99
                minimum: -99999999999.99
                type: number
                description: "The amount from the total tax return charge that has\
                  \ been coded out. \r\nThe value must be between -9999.99 and 2999.99\
                  \ to 2 decimal places."
                example: 5009.99
              reducedCharge:
                type: object
                properties:
                  chargeType:
                    type: string
                    description: "Document name of charge reduced. \r\nThis will be\
                      \ the Charge type name of the original charge"
                    example: AA
                  documentNumber:
                    type: string
                    description: "If Charge has been reduced, and credit arises, the\
                      \ document number to be shown. \r\nThis will be the SAP Document\
                      \ number of this document"
                    example: "1234567890123456"
                  amendmentDate:
                    type: string
                    description: "Amendment date of charge that has been reduced.\
                      \ \r\nThis will be the date the charge was reduced/changed/reversed\
                      \ in the format YYYY-MM-DD."
                    example: 2018-04-05
                  taxYear:
                    type: string
                    description: "Tax Year of Charge that has been reduced. \r\nThis\
                      \ is the tax year on the original charge."
                    example: 2018-19
                description: Details if Charge has been reduced.
              poaRelevantAmount:
                multipleOf: 0.01
                maximum: 99999999999.99
                minimum: -99999999999.99
                type: number
                description: "Payments on account relevant amount. \r\nThe value must\
                  \ be between -99999999999.99 and 99999999999.99 to 2 decimal places."
                example: 8999.98
            description: An object containing document details
        financialDetails:
          type: array
          items:
            required:
            - chargeDetail
            - items
            - taxYear
            type: object
            properties:
              taxYear:
                type: string
                description: "The tax year to which the charge relates, in the format\
                  \ YYYY-YY"
                example: 2020-21
              chargeDetail:
                required:
                - documentId
                type: object
                properties:
                  documentId:
                    type: string
                    description: "DocumentID may contain SAP document number or Form\
                      \ Bundle Number for zero-amount documents. Must conform to the\
                      \ regular expression ^[0-9a-zA-Z]{1,12}$"
                    example: XAIS12345678910
                  documentType:
                    type: string
                    description: A unique ID is used to reference the document type
                      of which this is a subitem.
                    example: "1234"
                  documentTypeDescription:
                    type: string
                    description: The Description of the main charge type
                    example: SA Balancing Charge
                  chargeType:
                    type: string
                    description: A unique ID is used to identify the type of sub-item.
                    example: "3175"
                  chargeTypeDescription:
                    type: string
                    description: |-
                      Name of charge type.
                      Must conform to the regular expression:
                      ^[0-9A-Za-z]{1,30}$
                    example: Income Tax Estimate - NIC2 NI
              taxPeriodFrom:
                type: string
                description: |-
                  The 'from' date of this tax period.
                  Date in the format: YYYY-MM-DD
                example: 2020-04-06
              taxPeriodTo:
                type: string
                description: |-
                  The 'to' date of this tax period.
                  Date in the format: YYYY-MM-DD
                example: 2021-04-05
              contractAccount:
                type: string
                description: A contract account is the accounting record for a particular
                  charge type.
                example: X
              documentNumber:
                type: string
                description: "Same as Document Number/ID unless on output there is\
                  \ no postings (zero amounts) then the Form Bundle is returned \n\
                  \nMust conform to the regular expression: ^[0-9A-Za-z]{1,12}$"
                example: "1040000872"
              documentNumberItem:
                type: string
                description: An identifier for this part of the overall transaction
                  is used to link an allocation and charge.
                example: XM00
              chargeReference:
                type: string
                description: A unique reference number is associated with the charge.
                example: XM002610011594
              originalAmount:
                type: number
                description: |-
                  The original amount of this transaction.
                  The value must be between -99999999999.99 and 99999999999.99 to 2 decimal places.
                example: 5009.99
              outstandingAmount:
                type: number
                description: |-
                  The remaining amount is due on this transaction.
                  The value must be between -99999999999.99 and 99999999999.99 to 2 decimal places.
                example: 5009.99
              clearedAmount:
                type: number
                description: "The cleared value of this transaction. For example,\
                  \ the paid amount of a charge. \nThe value must be between -99999999999.99\
                  \ and 99999999999.99 to 2 decimal places."
                example: 5009.99
              accruedInterest:
                type: number
                description: |-
                  The accrued interest of this transaction.
                  Accrued interest is interest calculated and charged.
                  The value must be between -99999999999.99 and 99999999999.99 to 2 decimal places
                example: 5009.99
              items:
                title: Retrieve History of a Self Assessment Charge
                type: array
                description: This endpoint enables you to retrieve the history of
                  changes to a single charge made by HMRC. A National Insurance number
                  and transaction ID must be provided.
                items:
                  type: object
                  properties:
                    itemId:
                      type: string
                      description: An identifier for the item in the list.
                      example: "001"
                    dueDate:
                      type: string
                      description: "If the requested item relates to a charge, the\
                        \ due date is the date by which the amount is due to be paid.\
                        \ If the requested item relates to a payment, the due date\
                        \ refers to the date the payment was made to HMRC in the format\
                        \ YYY-MM-DD"
                      example: 2018-04-05
                    amount:
                      multipleOf: 0.01
                      maximum: 99999999999.99
                      minimum: -99999999999.99
                      type: number
                      description: The amount that this entry changed the transaction
                        by. The value must be between -99999999999.99 and 99999999999.99
                        to 2 decimal places.
                      example: 5009.99
                    clearingDate:
                      type: string
                      description: "The date this entry changed the item, in the format\
                        \ YYYY-MM-DD."
                      example: 2018-04-05
                    clearingReason:
                      type: string
                      description: The reason for the change to the item.
                      example: Incoming Payment
                      enum:
                      - Incoming Payment
                      - Outgoing Payment
                      - Reversal
                      - Manual Clearing
                      - Automatic Clearing
                    outgoingPaymentMethod:
                      type: string
                      description: "The method used to make the outgoing payment.\
                        \ One of Repayment to Card, Payable Order Repayment or BACS\
                        \ Payment out"
                      example: Payable Order Repayment
                      enum:
                      - Repayment to Card
                      - Payable Order Repayment
                      - BACS Payment out
                    locks:
                      required:
                      - isChargeOnHold
                      - isEstimatedChargeOnHold
                      - isInterestAccrualOnHold
                      - isInterestChargeOnHold
                      type: object
                      properties:
                        isChargeOnHold:
                          type: boolean
                          description: A signal that indicates that the charge has
                            been paused whilst under review or investigation.
                          example: false
                        isEstimatedChargeOnHold:
                          type: boolean
                          description: A clearing lock is used only for statistical
                            or forecasted charges.
                          example: false
                        isInterestAccrualOnHold:
                          type: boolean
                          description: Indicates if the charge is not accruing interest
                            due to a review or investigation.
                          example: true
                        isInterestChargeOnHold:
                          type: boolean
                          description: A lock has been put in so the interest will
                            not be charged to the customer.
                          example: true
                      description: An object holding the lock fields
                    isReturn:
                      type: boolean
                      description: "If it is true, that means the charge has been\
                        \ generated by a return."
                      example: true
                    paymentReference:
                      type: string
                      description: A unique reference number is associated with the
                        payment.
                      example: Ab12453535
                    paymentAmount:
                      multipleOf: 0.01
                      maximum: 99999999999.99
                      minimum: -99999999999.99
                      type: number
                      description: |-
                        If the item relates to a payment, the payment amount is the amount of the payment received into the account.

                        If the item relates to a charge, the payment amount is the amount that this entry changed the transaction by. The value must be between -99999999999.99 and 99999999999.99 to 2 decimal places.
                      example: 5009.99
                    paymentMethod:
                      type: string
                      description: The method used to make the payment.
                      example: BACS RECEIPTS
                    paymentLot:
                      type: string
                      description: "If the item is a payment, the payment lot is a\
                        \ unique identifier for a credit. If the item is a charge,\
                        \ the payment lot is a unique identifier for an allocation\
                        \ within the charge and allows you to identify where the payment\
                        \ came from."
                      example: "81203010024"
                    paymentLotItem:
                      type: string
                      description: A unique ID is used in combination with a payment
                        ID to refer to an individual payment or credit.
                      example: "000001"
                    clearingSAPDocument:
                      type: string
                      description: "When a payment is used against a charge, this\
                        \ links payment and charge together."
                      example: "3350000253"
                    isChargeEstimate:
                      type: boolean
                      description: Indicates whether the item represents an estimated
                        charge.
                      example: true
                  description: The list of items as part of the financial details
            description: A list of charges that make up the overall transaction. The
              items may include subitems.
      additionalProperties: false
      description: "This endpoint enables you to retrieve the overall liability broken\
        \ down into overdue, currently due (payable), and pending (not yet due) amounts.\
        \ A National Insurance number must be provided."
    response_2:
      required:
      - links
      - payments
      type: object
      properties:
        payments:
          type: array
          description: An array containing payments made by the customer.
          items:
            required:
            - allocations
            type: object
            properties:
              paymentLot:
                type: string
                description: An identifier for the batch process that processed the
                  payment and assigned it to the taxpayer's account.
                example: AB1023456789-000001
              paymentLotItem:
                type: string
                description: An identifier for each payment within a payment lot.
                  paymentLot and paymentLotItem together uniquely identify a payment.
                example: "000001"
              paymentReference:
                type: string
                description: A unique reference number associated with the payment.
                example: "000001700000001"
              paymentAmount:
                type: number
                description: "The amount of the payment received into the account.\
                  \ \n\nThe value must be between -99999999999.99 and 99999999999.99\
                  \ up to 2 decimal places."
                example: 10000.00
              paymentMethod:
                type: string
                description: "The method used to make the payment. \n\nMust conform\
                  \ to the regular expression:\n^[0-9A-Za-z]{1,30}$"
                example: "BACS, Payment by card"
              transactionDate:
                type: string
                description: "The date the payment was received into the account in\
                  \ the format: YYYY-MM-DD"
                example: 2018-04-05
              allocations:
                type: array
                description: A list of charges which are allocated amounts from the
                  payment
                items:
                  required:
                  - chargeReference
                  type: object
                  properties:
                    chargeReference:
                      type: string
                      description: A unique reference for the original charge that
                        the payment was made against.
                      example: XM002610011595
                    periodKey:
                      type: string
                      description: |-
                        The period key attributed to the charge.

                        A four digit reference containing characters and numbers to identify the specific tax period.
                      example: 16RL
                    periodKeyDescription:
                      type: string
                      description: A description of the period key as a tax period.
                      example: 6th April 2020 to 5th April 2021
                    startDate:
                      type: string
                      description: The start date of the tax year for the charge in
                        the format YYYY-MM-DD
                      example: 2018-04-06
                    endDate:
                      type: string
                      description: The end date of the tax year for the charge in
                        the format YYYY-MM-DD
                      example: 2019-04-05
                    dueDate:
                      type: string
                      description: The date the charge must be paid by. Interest or
                        penalties will be accrued after this date.
                      example: 2019-07-27
                    chargeDetail:
                      type: object
                      properties:
                        documentId:
                          type: string
                          description: "Same as Document Number unless on output there\
                            \ are no postings then the Form Bundle number is returned.\
                            \ Must conform to the regular expression: ^[0-9A-Za-z]{1,12}$"
                          example: "1040000872"
                        documentType:
                          type: string
                          description: A code to specify the document type of which
                            this is a subitem.
                          example: "3880"
                        documentTypeDescription:
                          type: string
                          description: Description of the document type.
                          example: Income Tax Estimate
                        chargeType:
                          type: string
                          description: A code to specify the type of charge.
                          example: "1005"
                        chargeTypeDescription:
                          type: string
                          description: Description of the charge type.
                          example: Income Tax Estimate -  ITSA
                    amount:
                      type: number
                      description: |-
                        The original value of this transaction.

                        The value must be between -99999999999.99 and 99999999999.99 up to 2 decimal places.
                      example: 600.00
                    clearedAmount:
                      type: number
                      description: |-
                        The cleared value of this transaction.

                        The value must be between -99999999999.99 and 99999999999.99 up to 2 decimal places.
                      example: 600.00
                    contractAccount:
                      type: string
                      description: The accounting record for a particular charge type.
                      example: "000404772537"
        links:
          type: array
          items:
            required:
            - href
            - method
            - rel
            type: object
            properties:
              method:
                type: string
                description: The HTTP method type for the endpoint.
                enum:
                - GET
              rel:
                type: string
                description: "A label for the endpoint, which describes how it is\
                  \ related to the current resource. The rel will be self where\
                  \ the action is retrieval of the same resource."
                enum:
                - self
              href:
                type: string
                description: The relative URL of the endpoint.
                example: /accounts/self-assessment/AA999999A/payments-and-allocations
    response_3:
      required:
      - nino
      - optOutIndicator
      - processingDate
      - taxYear
      type: object
      properties:
        processingDate:
          type: string
          description: The date and time that the request was processed in the system.
          format: date-time
        nino:
          type: string
          description: "National Insurance number, in the format AA999999A."
        taxYear:
          pattern: "^2[0-9]{3}-[0-9]{2}$"
          type: string
          description: "The tax year the data applies to, for example 2021-22. The\
            \ start year and end year must not span two tax years. The minimum tax\
            \ year is 2021-22. No gaps are allowed, for example, 2020-22 is not valid.\
            \ (The minimum tax year in Sandbox is 2019-20.)."
        optOutIndicator:
          type: boolean
          description: |-
            Indicates the coding out status of the tax year.
            - true: Customer opted out of coding out for the tax year
            - false: Customer opted in to coding out for the tax year
      additionalProperties: false
    balanceDetails:
      required:
      - bcdBalancePerYear
      - overdueAmount
      - payableAmount
      - pendingChargeDueAmount
      - totalBalance
      type: object
      properties:
        payableAmount:
          type: number
          description: The sum of any non-zero charges whose payment due date is within
            30 days. The value must be between -99999999999.99 and 99999999999.99
            to 2 decimal places.
          example: 5009.99
        payableDueDate:
          type: string
          description: Next payment date for charges due in the format YYYY-MM-DD.
          example: 2018-04-05
        pendingChargeDueAmount:
          type: number
          description: The sum of any charges whose payment is pending (not yet due).
            The value must be between -99999999999.99 and 99999999999.99 to 2 decimal
            places.
          example: 5009.99
        pendingChargeDueDate:
          type: string
          description: The date by when the next pending (not yet due) charge must
            be paid in the format YYYY-MM-DD.
          example: 2018-04-05
        overdueAmount:
          type: number
          description: "The total amount of charges under each documentID whose due\
            \ date is in the past Accrued Interest Amount / LPI Amount will also be\
            \ included (where applicable). \r\n The value must be between -99999999999.99\
            \ and 99999999999.99 to 2 decimal places."
          example: 5009.99
        bcdBalancePerYear:
          type: array
          description: An array containing balance charge debit payment details.
          items:
            required:
            - bcdAmount
            - taxYear
            type: object
            properties:
              taxYear:
                type: string
                description: The tax year for the appropriate balance charge debit.
                example: 2018-19
              bcdAmount:
                type: number
                description: "The balancing charge debit amount is the balancing payment\
                  \ due by the taxpayer calculated when the return is captured.\r\n\
                  The value must be between -99999999999.99 and 99999999999.99 to\
                  \ 2 decimal places."
                example: 5009.99
        earliestPaymentDateOverdue:
          type: string
          description: The next day after the payment due date in the format YYYY-MM-DD
          example: 2018-04-05
        totalBalance:
          type: number
          description: "The sum of all the unpaid charges excluding statistical and\
            \  EOY coded out. The total balance should be equal to the sum of the\
            \ balance due within 30 days, balance not due in 30 days, and overdue\
            \ amount.\r\nThe value must be between -99999999999.99 and 99999999999.99\
            \ to 2 decimal places."
          example: 5009.99
        amountCodedOut:
          type: number
          description: "The total amount of underpayment codeout.\r\nThe value must\
            \ be between -99999999999.99 and 99999999999.99 to 2 decimal places."
          example: 5009.99
        totalBcdBalance:
          type: number
          description: "The total of the Balance charge debit balance amount.\r\n\
            The value must be between -99999999999.99 and 99999999999.99 to 2 decimal\
            \ places"
          example: 5009.99
        unallocatedCredit:
          type: number
          description: "Sum of all the Open credit Items on the customer's account,\
            \ posted for Income tax Self-assessment.\r\nThe value must be between\
            \ -99999999999.99 and 99999999999.99 to 2 decimal places."
          example: 5009.99
        allocatedCredit:
          type: number
          description: "Sum of all the closed credit items on the customer's account,\
            \ posted for  Income tax Self-assessment.\r\nThe value must be between\
            \ -99999999999.99 and 99999999999.99 to 2 decimal places."
          example: 5009.99
        totalCredit:
          type: number
          description: "Sum of unallocated credit + allocated credit.\r\nThe value\
            \ must be between -99999999999.99 and 99999999999.99 to 2 decimal places."
          example: 5009.99
        firstPendingAmountRequested:
          type: number
          description: "This will be the first pending amount that is requested.\r\
            \nThe value must be between -99999999999.99 and 99999999999.99 to 2 decimal\
            \ places."
          example: 5009.99
        secondPendingAmountRequested:
          type: number
          description: "This will be the second pending amount that is requested.\r\
            \nThe value must be between -99999999999.99 and 99999999999.99 to 2 decimal\
            \ places."
          example: 5009.99
        availableCredit:
          type: number
          description: "This will be equal to total credit minus the pending amount(s)\
            \ requested.\r\nThe value must be between -99999999999.99 and 99999999999.99\
            \ to 2 decimal places."
          example: 5009.99
    codingDetails:
      title: Retrieve coding details
      type: array
      description: An Object containing coding details
      items:
        type: object
        properties:
          returnTaxYear:
            type: string
            description: The ending year of the tax year to which the return relates
              is in the format YYYY-YY.
            example: 2021-22
          totalLiabilityAmount:
            multipleOf: 0.01
            maximum: 99999999999.99
            minimum: -99999999999.99
            type: number
            description: The total amount of the Self Assessment tax return inclusive
              of coded charges. The value must be between -99999999999.99 and 99999999999.99
              up to 2 decimal places.
            example: 5009.99
          codingTaxYear:
            type: string
            description: The tax year that the coded out charge will be attached to.
            example: 2021-22
          coded:
            type: object
            properties:
              charge:
                multipleOf: 0.01
                maximum: 99999999999.99
                minimum: -99999999999.99
                type: number
                description: The coded out charge. The value must be between -99999999999.99
                  and 99999999999.99 up to 2 decimal places.
                example: 5009.99
              initiationDate:
                type: string
                description: "Initiation date of the coded out charge, in the format\
                  \ YYYY-MM-DD."
                example: 2021-04-05
            description: An object containing a coded amount and initiation date
    documentDetails:
      type: array
      description: An array containing document details
      items:
        required:
        - documentDate
        - documentId
        - isChargeEstimate
        - isCodedOut
        - originalAmount
        - outstandingAmount
        type: object
        properties:
          taxYear:
            type: string
            description: "The tax year of the Document (Billing period from  billing\
              \ period to), in the format YYYY-YY. For example, the tax year 2020\
              \ to 2021 is expressed as 2020-21."
            example: 2020-21
          documentId:
            type: string
            description: "DocumentID may contain SAP document number or Form Bundle\
              \ Number for zero-amount documents. Must conform to the regular expression\
              \ ^[0-9a-zA-Z]{1,12}$"
            example: "1455"
          formBundleNumber:
            type: string
            description: 'The form bundle number designates a package of related transactions
              gathered together. '
            example: "88888888"
          creditReason:
            type: string
            description: Credit Reason gives the reason as to why there is a credit
              on the account.
            example: Voluntary Payment
            enum:
            - Voluntary Payment
            - Income tax Self Assessment Return
            - Excess Payment
          documentDate:
            type: string
            description: The date when the document for a particular tax group containing
              charges was created in the format YYYY-MM-DD.
            example: 2018-04-05
          documentText:
            type: string
            description: Provides details about the tax group that the charge belongs
              to.
            example: ITSA- Bal Charge
          documentDueDate:
            type: string
            description: The date the item must be received in the format YYYY-MM-DD.
            example: 2021-04-05
          documentDescription:
            type: string
            description: The primary method to identify what type of document has
              been called.
            example: ITSA- POA 1
            enum:
            - ITSA- POA 1
            - ITSA - POA 2
            - ITSA- Bal Charge
            - New Charge
            - Clearing Document
            - TRM New Charge
            - TRM Amend Charge
            - Payment
            - Repayment
          originalAmount:
            multipleOf: 0.01
            maximum: 99999999999.99
            minimum: -99999999999.99
            type: number
            description: "The original value of this transaction before payments,\
              \ credits, or adjustments.\r\nThe value must be between -99999999999.99\
              \ and 99999999999.99 to 2 decimal places."
            example: 5000.99
          outstandingAmount:
            multipleOf: 0.01
            maximum: 99999999999.99
            minimum: -99999999999.99
            type: number
            description: "The amount remaining of this transaction after payments,\
              \ credits, or adjustments.\r\nThe value must be between -99999999999.99\
              \ and 99999999999.99 to 2 decimal places."
            example: 5000.99
          lastClearing:
            type: object
            properties:
              lastClearingDate:
                type: string
                description: "The date the outstanding amount was last modified, in\
                  \ the format YYYY-MM-DD."
                example: 2018-04-05
              lastClearingReason:
                type: string
                description: "The reason for the change. For example, an interest\
                  \ charge was created."
                example: Incoming Payment
                enum:
                - Incoming Payment
                - Outgoing Payment
                - Other
                - Write-Off
                - Reversal
              lastClearedAmount:
                multipleOf: 0.01
                maximum: 99999999999.99
                minimum: -99999999999.99
                type: number
                description: The amount the transaction was last modified by. The
                  value must be between -99999999999.99 and 99999999999.99 to 2 decimal
                  places.
                example: 5000.99
            description: Details if the amount was previously modified.
          isChargeEstimate:
            type: boolean
            description: An indicator to represent that the charge is an estimate
              and not an actual charge. The value must be true or false.
            example: false
          isCodedOut:
            type: boolean
            description: An indicator to represent that the charge has been sent for
              coding out.
            example: false
          paymentLot:
            type: string
            description: A unique identifier for a credit that has been made direct
              to ETMP.
            example: AB1023456789
          paymentLotItem:
            type: string
            description: A unique ID that is used in combination with Payment Lot
              to refer to an individual payment.
            example: "000001"
          effectiveDateOfPayment:
            type: string
            description: The effective date of payment in the format YYYY-MM-DD.
            example: 2021-04-05
          latePaymentInterest:
            type: object
            properties:
              latePaymentInterestId:
                type: string
                description: Late Payment Interest ID is the Charge Reference Number
                  of all the monthly and final interest charges of the same parent
                  charge.
                example: "1234567890123456"
              accruingInterestAmount:
                multipleOf: 0.01
                maximum: 99999999999.99
                minimum: -99999999999.99
                type: number
                description: "The total value of all the monthly interest charges\
                  \ and accruing (unposted) interest charges is grouped by Charge\
                  \ Reference level. \r\nThe value must be between -99999999999.99\
                  \ and 99999999999.99 to 2 decimal places.\r\n"
                example: 5000.99
              interestRate:
                multipleOf: 0.01
                maximum: 99.99
                minimum: 0
                type: number
                description: The latest interest rate for late payments. The value
                  must be between 0 and 99.99 to 2 decimal places.
                example: 5.99
              interestStartDate:
                type: string
                description: The date the interest charges started in the format YYYY-MM-DD.
                example: 2020-04-05
              interestEndDate:
                type: string
                description: The date the interest charges ended in the format YYYY-MM-DD.
                example: 2020-05-05
              interestAmount:
                multipleOf: 0.01
                maximum: 99999999999.99
                minimum: -99999999999.99
                type: number
                description: "The total value of all the monthly interest charges\
                  \ and final interest charges is grouped by Charge Reference level.\r\
                  \nThe value must be between -99999999999.99 and 99999999999.99 to\
                  \ 2 decimal places."
                example: 201.99
              interestDunningLockAmount:
                multipleOf: 0.01
                maximum: 99999999999.99
                minimum: -99999999999.99
                type: number
                description: "Late payment interest amount where the  Interest is\
                  \ temporarily not being charged on (A lock has been put so the interest\
                  \ will not be charged to the customer). \r\nThe value must be between\
                  \ -99999999999.99 and 99999999999.99 to 2 decimal places."
                example: 5009.99
              interestOutstandingAmount:
                multipleOf: 0.01
                maximum: 99999999999.99
                minimum: -99999999999.99
                type: number
                description: "TThe unpaid amount of Accruing Interest or Late Payment\
                  \ Interest. \r\nThe value must be between -99999999999.99 and 99999999999.99\
                  \ to 2 decimal places."
                example: 5000.99
            description: An object containing late payment interest details.
          amountCodedOut:
            multipleOf: 0.01
            maximum: 99999999999.99
            minimum: -99999999999.99
            type: number
            description: "The amount from the total tax return charge that has been\
              \ coded out. \r\nThe value must be between -9999.99 and 2999.99 to 2\
              \ decimal places."
            example: 5009.99
          reducedCharge:
            type: object
            properties:
              chargeType:
                type: string
                description: "Document name of charge reduced. \r\nThis will be the\
                  \ Charge type name of the original charge"
                example: AA
              documentNumber:
                type: string
                description: "If Charge has been reduced, and credit arises, the document\
                  \ number to be shown. \r\nThis will be the SAP Document number of\
                  \ this document"
                example: "1234567890123456"
              amendmentDate:
                type: string
                description: "Amendment date of charge that has been reduced. \r\n\
                  This will be the date the charge was reduced/changed/reversed in\
                  \ the format YYYY-MM-DD."
                example: 2018-04-05
              taxYear:
                type: string
                description: "Tax Year of Charge that has been reduced. \r\nThis is\
                  \ the tax year on the original charge."
                example: 2018-19
            description: Details if Charge has been reduced.
          poaRelevantAmount:
            multipleOf: 0.01
            maximum: 99999999999.99
            minimum: -99999999999.99
            type: number
            description: "Payments on account relevant amount. \r\nThe value must\
              \ be between -99999999999.99 and 99999999999.99 to 2 decimal places."
            example: 8999.98
        description: An object containing document details
    financialDetails:
      type: array
      items:
        required:
        - chargeDetail
        - items
        - taxYear
        type: object
        properties:
          taxYear:
            type: string
            description: "The tax year to which the charge relates, in the format\
              \ YYYY-YY"
            example: 2020-21
          chargeDetail:
            required:
            - documentId
            type: object
            properties:
              documentId:
                type: string
                description: "DocumentID may contain SAP document number or Form Bundle\
                  \ Number for zero-amount documents. Must conform to the regular\
                  \ expression ^[0-9a-zA-Z]{1,12}$"
                example: XAIS12345678910
              documentType:
                type: string
                description: A unique ID is used to reference the document type of
                  which this is a subitem.
                example: "1234"
              documentTypeDescription:
                type: string
                description: The Description of the main charge type
                example: SA Balancing Charge
              chargeType:
                type: string
                description: A unique ID is used to identify the type of sub-item.
                example: "3175"
              chargeTypeDescription:
                type: string
                description: |-
                  Name of charge type.
                  Must conform to the regular expression:
                  ^[0-9A-Za-z]{1,30}$
                example: Income Tax Estimate - NIC2 NI
          taxPeriodFrom:
            type: string
            description: |-
              The 'from' date of this tax period.
              Date in the format: YYYY-MM-DD
            example: 2020-04-06
          taxPeriodTo:
            type: string
            description: |-
              The 'to' date of this tax period.
              Date in the format: YYYY-MM-DD
            example: 2021-04-05
          contractAccount:
            type: string
            description: A contract account is the accounting record for a particular
              charge type.
            example: X
          documentNumber:
            type: string
            description: "Same as Document Number/ID unless on output there is no\
              \ postings (zero amounts) then the Form Bundle is returned \n\nMust\
              \ conform to the regular expression: ^[0-9A-Za-z]{1,12}$"
            example: "1040000872"
          documentNumberItem:
            type: string
            description: An identifier for this part of the overall transaction is
              used to link an allocation and charge.
            example: XM00
          chargeReference:
            type: string
            description: A unique reference number is associated with the charge.
            example: XM002610011594
          originalAmount:
            type: number
            description: |-
              The original amount of this transaction.
              The value must be between -99999999999.99 and 99999999999.99 to 2 decimal places.
            example: 5009.99
          outstandingAmount:
            type: number
            description: |-
              The remaining amount is due on this transaction.
              The value must be between -99999999999.99 and 99999999999.99 to 2 decimal places.
            example: 5009.99
          clearedAmount:
            type: number
            description: "The cleared value of this transaction. For example, the\
              \ paid amount of a charge. \nThe value must be between -99999999999.99\
              \ and 99999999999.99 to 2 decimal places."
            example: 5009.99
          accruedInterest:
            type: number
            description: |-
              The accrued interest of this transaction.
              Accrued interest is interest calculated and charged.
              The value must be between -99999999999.99 and 99999999999.99 to 2 decimal places
            example: 5009.99
          items:
            title: Retrieve History of a Self Assessment Charge
            type: array
            description: This endpoint enables you to retrieve the history of changes
              to a single charge made by HMRC. A National Insurance number and transaction
              ID must be provided.
            items:
              type: object
              properties:
                itemId:
                  type: string
                  description: An identifier for the item in the list.
                  example: "001"
                dueDate:
                  type: string
                  description: "If the requested item relates to a charge, the due\
                    \ date is the date by which the amount is due to be paid. If the\
                    \ requested item relates to a payment, the due date refers to\
                    \ the date the payment was made to HMRC in the format YYY-MM-DD"
                  example: 2018-04-05
                amount:
                  multipleOf: 0.01
                  maximum: 99999999999.99
                  minimum: -99999999999.99
                  type: number
                  description: The amount that this entry changed the transaction
                    by. The value must be between -99999999999.99 and 99999999999.99
                    to 2 decimal places.
                  example: 5009.99
                clearingDate:
                  type: string
                  description: "The date this entry changed the item, in the format\
                    \ YYYY-MM-DD."
                  example: 2018-04-05
                clearingReason:
                  type: string
                  description: The reason for the change to the item.
                  example: Incoming Payment
                  enum:
                  - Incoming Payment
                  - Outgoing Payment
                  - Reversal
                  - Manual Clearing
                  - Automatic Clearing
                outgoingPaymentMethod:
                  type: string
                  description: "The method used to make the outgoing payment. One\
                    \ of Repayment to Card, Payable Order Repayment or BACS Payment\
                    \ out"
                  example: Payable Order Repayment
                  enum:
                  - Repayment to Card
                  - Payable Order Repayment
                  - BACS Payment out
                locks:
                  required:
                  - isChargeOnHold
                  - isEstimatedChargeOnHold
                  - isInterestAccrualOnHold
                  - isInterestChargeOnHold
                  type: object
                  properties:
                    isChargeOnHold:
                      type: boolean
                      description: A signal that indicates that the charge has been
                        paused whilst under review or investigation.
                      example: false
                    isEstimatedChargeOnHold:
                      type: boolean
                      description: A clearing lock is used only for statistical or
                        forecasted charges.
                      example: false
                    isInterestAccrualOnHold:
                      type: boolean
                      description: Indicates if the charge is not accruing interest
                        due to a review or investigation.
                      example: true
                    isInterestChargeOnHold:
                      type: boolean
                      description: A lock has been put in so the interest will not
                        be charged to the customer.
                      example: true
                  description: An object holding the lock fields
                isReturn:
                  type: boolean
                  description: "If it is true, that means the charge has been generated\
                    \ by a return."
                  example: true
                paymentReference:
                  type: string
                  description: A unique reference number is associated with the payment.
                  example: Ab12453535
                paymentAmount:
                  multipleOf: 0.01
                  maximum: 99999999999.99
                  minimum: -99999999999.99
                  type: number
                  description: |-
                    If the item relates to a payment, the payment amount is the amount of the payment received into the account.

                    If the item relates to a charge, the payment amount is the amount that this entry changed the transaction by. The value must be between -99999999999.99 and 99999999999.99 to 2 decimal places.
                  example: 5009.99
                paymentMethod:
                  type: string
                  description: The method used to make the payment.
                  example: BACS RECEIPTS
                paymentLot:
                  type: string
                  description: "If the item is a payment, the payment lot is a unique\
                    \ identifier for a credit. If the item is a charge, the payment\
                    \ lot is a unique identifier for an allocation within the charge\
                    \ and allows you to identify where the payment came from."
                  example: "81203010024"
                paymentLotItem:
                  type: string
                  description: A unique ID is used in combination with a payment ID
                    to refer to an individual payment or credit.
                  example: "000001"
                clearingSAPDocument:
                  type: string
                  description: "When a payment is used against a charge, this links\
                    \ payment and charge together."
                  example: "3350000253"
                isChargeEstimate:
                  type: boolean
                  description: Indicates whether the item represents an estimated
                    charge.
                  example: true
              description: The list of items as part of the financial details
        description: A list of charges that make up the overall transaction. The items
          may include subitems.
    itemDetails:
      title: Retrieve History of a Self Assessment Charge
      type: array
      description: This endpoint enables you to retrieve the history of changes to
        a single charge made by HMRC. A National Insurance number and transaction
        ID must be provided.
      items:
        type: object
        properties:
          itemId:
            type: string
            description: An identifier for the item in the list.
            example: "001"
          dueDate:
            type: string
            description: "If the requested item relates to a charge, the due date\
              \ is the date by which the amount is due to be paid. If the requested\
              \ item relates to a payment, the due date refers to the date the payment\
              \ was made to HMRC in the format YYY-MM-DD"
            example: 2018-04-05
          amount:
            multipleOf: 0.01
            maximum: 99999999999.99
            minimum: -99999999999.99
            type: number
            description: The amount that this entry changed the transaction by. The
              value must be between -99999999999.99 and 99999999999.99 to 2 decimal
              places.
            example: 5009.99
          clearingDate:
            type: string
            description: "The date this entry changed the item, in the format YYYY-MM-DD."
            example: 2018-04-05
          clearingReason:
            type: string
            description: The reason for the change to the item.
            example: Incoming Payment
            enum:
            - Incoming Payment
            - Outgoing Payment
            - Reversal
            - Manual Clearing
            - Automatic Clearing
          outgoingPaymentMethod:
            type: string
            description: "The method used to make the outgoing payment. One of Repayment\
              \ to Card, Payable Order Repayment or BACS Payment out"
            example: Payable Order Repayment
            enum:
            - Repayment to Card
            - Payable Order Repayment
            - BACS Payment out
          locks:
            required:
            - isChargeOnHold
            - isEstimatedChargeOnHold
            - isInterestAccrualOnHold
            - isInterestChargeOnHold
            type: object
            properties:
              isChargeOnHold:
                type: boolean
                description: A signal that indicates that the charge has been paused
                  whilst under review or investigation.
                example: false
              isEstimatedChargeOnHold:
                type: boolean
                description: A clearing lock is used only for statistical or forecasted
                  charges.
                example: false
              isInterestAccrualOnHold:
                type: boolean
                description: Indicates if the charge is not accruing interest due
                  to a review or investigation.
                example: true
              isInterestChargeOnHold:
                type: boolean
                description: A lock has been put in so the interest will not be charged
                  to the customer.
                example: true
            description: An object holding the lock fields
          isReturn:
            type: boolean
            description: "If it is true, that means the charge has been generated\
              \ by a return."
            example: true
          paymentReference:
            type: string
            description: A unique reference number is associated with the payment.
            example: Ab12453535
          paymentAmount:
            multipleOf: 0.01
            maximum: 99999999999.99
            minimum: -99999999999.99
            type: number
            description: |-
              If the item relates to a payment, the payment amount is the amount of the payment received into the account.

              If the item relates to a charge, the payment amount is the amount that this entry changed the transaction by. The value must be between -99999999999.99 and 99999999999.99 to 2 decimal places.
            example: 5009.99
          paymentMethod:
            type: string
            description: The method used to make the payment.
            example: BACS RECEIPTS
          paymentLot:
            type: string
            description: "If the item is a payment, the payment lot is a unique identifier\
              \ for a credit. If the item is a charge, the payment lot is a unique\
              \ identifier for an allocation within the charge and allows you to identify\
              \ where the payment came from."
            example: "81203010024"
          paymentLotItem:
            type: string
            description: A unique ID is used in combination with a payment ID to refer
              to an individual payment or credit.
            example: "000001"
          clearingSAPDocument:
            type: string
            description: "When a payment is used against a charge, this links payment\
              \ and charge together."
            example: "3350000253"
          isChargeEstimate:
            type: boolean
            description: Indicates whether the item represents an estimated charge.
            example: true
        description: The list of items as part of the financial details
  parameters:
    nino:
      name: nino
      in: path
      description: |
        National Insurance number, in the format `AA999999A`.
      required: true
      schema:
        type: string
        example: TC663795B
    transactionId:
      name: transactionId
      in: path
      description: "A unique identifier for this item. \n\nMust conform to the regular\
        \ expression\n^[0-9A-Za-z]{1,12}$\n"
      required: true
      schema:
        type: string
        example: X92AM39DLE3D
    acceptJson:
      name: Accept
      in: header
      description: |
        Specifies the response format and the version of the API to be used.
      required: true
      schema:
        type: string
        enum:
        - application/vnd.hmrc.3.0+json
    authorizationReadScopeHeader:
      name: Authorization
      in: header
      description: |
        An OAuth 2.0 Bearer Token with the *read:self-assessment* scope.
      required: true
      schema:
        type: string
        example: Bearer bb7fed3fe10dd235a2ccda3d50fb
    testScenarioHeader:
      name: Gov-Test-Scenario
      in: header
      description: |
        Only in sandbox environment. See Test Data table for all header values.
      required: false
      schema:
        type: string
        example: "-"
    chargeReference:
      name: chargeReference
      in: path
      description: "This field will be used when the need is to view a specific document\
        \ with help of Charge Reference number \n\nMust conform to the regular expression\n\
        ^[A-Za-z]{2}[0-9]{12}$\n"
      required: true
      schema:
        type: string
        example: Ck106547829351
    docNumber:
      name: docNumber
      in: query
      description: |
        The docNumber is a unique number per tax grouping in the Account display.
        (When onlyOpenItems has been set to false, either the date range (fromDate and toDate) or doc number should be supplied.)
      required: false
      schema:
        type: string
        example: "3060013199"
    fromDate:
      name: fromDate
      in: query
      description: The inclusive start date of the period to filter payments. The
        maximum date range between fromDate and toDate should not exceed 732 days.
      required: false
      schema:
        type: string
        example: 2019-01-02
    toDate:
      name: toDate
      in: query
      description: The inclusive end date of the period to filter payments. The maximum
        date range between fromDate and toDate should not exceed 732 days.
      required: false
      schema:
        type: string
        example: 2019-01-02
    onlyOpenItems:
      name: onlyOpenItems
      in: query
      description: |
        Limits the extraction to unpaid or not reversed charges.

        (When onlyOpenItems has been set to false, either the date range (fromDate and toDate) or docNumber should be supplied.)

        Defaults to false
      required: false
      schema:
        type: boolean
        example: false
    includeLocks:
      name: includeLocks
      in: query
      description: |
        Include additional information related to claim and debt management.

        Defaults to false
      required: false
      schema:
        type: boolean
        example: true
    calculateAccruedInterest:
      name: calculateAccruedInterest
      in: query
      description: |
        Calculate accrued interest. Accruing interest is the amount of interest calculated

        a) To todays date (or in the case of a created statement, to the statement date)

        b) On any overdue interest-bearing liability

        No interest charge is created for an amount of accruing interest. An interest charge is only created when the related liability is paid in full.
      required: false
      schema:
        type: boolean
        example: false
    removePOA:
      name: removePOA
      in: query
      description: |
        Remove Payment on Account details. When true, details of any payments that the customer has made will not be returned.

        Defaults to false.
      required: false
      schema:
        type: boolean
        example: false
    customerPaymentInformation:
      name: customerPaymentInformation
      in: query
      description: |
        Include customer payment information in the response. When true, the following information is returned:
        Payment Reference, Payment Amount, Payment Method, Payment Lot, Payment Lot Item, Clearing SAP Document.

        Note that if removePOA is true, no information is returned even if customerPaymentInformation is true.

        Defaults to false.
      required: false
      schema:
        type: boolean
        example: false
    includeEstimatedCharges:
      name: includeEstimatedCharges
      in: query
      description: |
        Include statistical (estimated) values for monthly payments.

        Defaults to false.
      required: false
      schema:
        type: boolean
        example: true
    paymentLot:
      name: paymentLot
      in: query
      description: An identifier for the batch process that processed the pagexyment
        and assigned it to the taxpayer's account.
      required: false
      schema:
        type: string
        example: "081203010024"
    paymentLotItem:
      name: paymentLotItem
      in: query
      description: An identifier for each payment within a payment lot. paymentLot
        and paymentLotItem together uniquely identify a payment.
      required: false
      schema:
        type: string
        example: "000001"
    source:
      name: source
      in: query
      description: |
        Specifies the source of data to be returned. If source is not provided, the latest values will be returned.<p> Limited to the following possible values: <ul><li>`hmrcHeld`<li>`user`<li>`latest`</p>
      required: false
      schema:
        type: string
    codingOutTaxYear:
      name: taxYear
      in: path
      description: |
        The tax year the data applies to, for example, 2021-22. The start year and end year must not span two tax years. No gaps are allowed, for example, 2020-22 is not valid.
      required: true
      schema:
        type: string
        example: 2021-22
  examples:
    formatNino:
      description: |
        The format of the supplied nino value is invalid.
      value:
        code: FORMAT_NINO
        message: The format of the supplied nino value is invalid.
    formatTransactionId:
      description: |
        The format of the supplied transaction identifier field is not valid.
      value:
        code: FORMAT_TRANSACTION_ID
        message: The format of the supplied transaction identifier field is not valid0
    ruleIncorrectGovTestScenario:
      description: "The request did not match any available Sandbox data. Check that\
        \ the supplied Gov-Test-Scenario is correct for \nthis endpoint version. This\
        \ error will only be returned in the Sandbox environment.\n"
      value:
        code: RULE_INCORRECT_GOV_TEST_SCENARIO
        message: The supplied Gov-Test-Scenario is not valid
    clientOrAgentNotAuthorised:
      description: |
        'The client or agent is not authorised. This is because: the client is not enrolled for MTD, the agent is not enrolled for Agent Services, the client has not authorised the agent to act on their behalf, or the Authorization token provided is not correct.'
      value:
        code: CLIENT_OR_AGENT_NOT_AUTHORISED
        message: "The client or agent is not authorised. This is because: the client\
          \ is not enrolled for MTD, the agent is not enrolled for Agent Services,\
          \ the client has not authorised the agent to act on their behalf, or the\
          \ Authorization token provided is not correct."
    notFound:
      description: |
        Matching resource not found.
      value:
        code: MATCHING_RESOURCE_NOT_FOUND
        message: Matching resource not found
    formatChargeReference:
      description: |
        The format of the supplied charge reference is not valid.
      value:
        code: FORMAT_CHARGE_REFERENCE
        message: The provided charge reference is invalid
    invalidDocNumber:
      description: |
        The format of docNumber is not valid.
      value:
        code: FORMAT_DOC_NUMBER
        message: The format of docNumber is not valid.
    invalidOnlyOpenItems:
      description: |
        The format of onlyOpenItem is not valid.
      value:
        code: FORMAT_ONLY_OPEN_ITEMS
        message: The format of onlyOpenItem is not valid.
    invalidIncludeLocks:
      description: |
        The format of includeLocks is not valid.
      value:
        code: FORMAT_INCLUDE_LOCKS
        message: The format of includeLocks is not valid.
    invalidCalculateAccruedInterest:
      description: |
        The format for calculatingAccruedInterest is not valid.
      value:
        code: FORMAT_CALCULATE_ACCRUED_INTEREST
        message: The format for calculatingAccruedInterest is not valid.
    invalidCustomerPaymentInformation:
      description: |
        The format of customerPaymentInformation is not valid.
      value:
        code: FORMAT_CUSTOMER_PAYMENT_INFORMATION
        message: The format of customerPaymentInformation is not valid.
    formatFromDate:
      description: |
        The format of the fromDate is not valid.
      value:
        code: FORMAT_FROM_DATE
        message: The format of the fromDate is not valid.
    formatToDate:
      description: |
        The format of toDate is not valid.
      value:
        code: FORMAT_TO_DATE
        message: The format of toDate is not valid.
    invalidRemovePaymentOnAccount:
      description: |
        The format of removePOA is not valid.
      value:
        code: FORMAT_REMOVE_PAYMENT_ON_ACCOUNT
        message: The format of removePOA is not valid.
    invalidIncludeChargeEstimate:
      description: |
        The format of includeEstimatedCharges is not valid
      value:
        code: FORMAT_INCLUDE_ESTIMATED_CHARGES
        message: The format of includeEstimatedCharges is not valid
    invalidDateRange:
      description: |
        The provided date range is not valid.
      value:
        code: RULE_INVALID_DATE_RANGE
        message: The provided date range is not valid.
    ruleInconsistentQueryParams:
      description: |
        Provide date range or docNumber when onlyOpenItems is false.
      value:
        code: RULE_INCONSISTENT_QUERY_PARAMS
        message: Provide date range or docNumber when onlyOpenItems is false.
    missingToDate:
      description: |
        The To date parameter is missing.
      value:
        code: MISSING_TO_DATE
        message: The To date parameter is missing.
    missingFromDate:
      description: |
        The From date parameter is missing
      value:
        code: MISSING_FROM_DATE
        message: The From date parameter is missing
    rangeToDateBeforeFromDate:
      description: |
        The To date must be after the From date.
      value:
        code: RANGE_TO_DATE_BEFORE_FROM_DATE
        message: The To date must be after the From date.
    ruleInconsistentQueryParamsListSA:
      description: |
        Provide either paymentLot & paymentLotItem or fromDate & toDate.
      value:
        code: RULE_INCONSISTENT_QUERY_PARAMS
        message: Provide either paymentLot & paymentLotItem or fromDate & toDate.
    formatPaymentLot:
      description: |
        The format of the supplied paymentLot value is not valid.
      value:
        code: FORMAT_PAYMENT_LOT
        message: The format of the supplied paymentLot value is not valid.
    formatPaymentLotItem:
      description: |
        The format of the supplied paymentLotItem value is not valid.
      value:
        code: FORMAT_PAYMENT_LOT_ITEM
        message: The format of the supplied paymentLotItem value is not valid.
    missingPaymentLot:
      description: |
        The paymentLotItem value has been provided, but paymentLot value is missing.
      value:
        code: MISSING_PAYMENT_LOT
        message: "The paymentLotItem value has been provided, but paymentLot value\
          \ is missing."
    missingPaymentLotItem:
      description: |
        The paymentLot value has been provided, but the paymentLotItem value is missing.
      value:
        code: MISSING_PAYMENT_LOT_ITEM
        message: "The paymentLot value has been provided, but the paymentLotItem value\
          \ is missing."
    formatTaxYear:
      description: |
        The format of the supplied taxYear value is invalid.
      value:
        code: FORMAT_TAX_YEAR
        message: The format of the supplied taxYear value is invalid.
    ruleBusinessPartnerNotExist:
      description: |
        The remote endpoint has indicated that business partner does not exist for NINO.
      value:
        code: RULE_BUSINESS_PARTNER_NOT_EXIST
        message: Provided NINO is not registered as business partner.
    ruleItsaContractObjectNotExist:
      description: |
        The remote endpoint has indicated that ITSA contract object does not exist.
      value:
        code: RULE_ITSA_CONTRACT_OBJECT_NOT_EXIST
        message: ITSA contract object does not exist.
    ruleAlreadyOptedOut:
      description: |
        The opt-out indicator cannot be set to the same value it currently holds.
      value:
        code: RULE_ALREADY_OPTED_OUT
        message: Customer is already opted out of coding out
    ruleTaxYearNotSupported:
      description: |
        The specified tax year is not supported. That is, the tax year specified is before the minimum tax year value.
      value:
        code: RULE_TAX_YEAR_NOT_SUPPORTED
        message: "The specified tax year is not supported. Either the tax year specified\
          \ is before the minimum tax year value, or it is after the maximum tax year\
          \ value."
    ruleTaxYearRangeInvalid:
      description: |
        A taxYear range of one year is required.
      value:
        code: RULE_TAX_YEAR_RANGE_INVALID
        message: A taxYear range of one year is required.
    ruleAlreadyOptedIn:
      description: |
        The remote endpoint has indicated that customer is already opted in to coding out.
      value:
        code: RULE_ALREADY_OPTED_IN
        message: Customer is already opted in to coding out
  headers:
    correlationId:
      description: |
        Unique ID for operation tracking
        String, 36 characters.
      required: true
      schema:
        type: string
        example: c75f40a6-a3df-4429-a697-471eeec46435
    deprecationHeader:
      description: |
        The deprecation date/time for this endpoint.
      required: false
      schema:
        type: string
        example: "Sun, 01 Jan 2023 23:59:59 GMT"
    sunsetHeader:
      description: |
        The earliest date/time this endpoint will become unavailable after deprecation.
      required: false
      schema:
        type: string
        example: "Sun, 02 Jul 2023 23:59:59 GMT"
    linkHeader:
      description: |
        URL of the documentation for the API.
      required: false
      schema:
        type: string
        example: https://developer.service.hmrc.gov.uk/api-documentation/docs/api/service/self-assessment-accounts-api
  securitySchemes:
    User-Restricted:
      type: oauth2
      description: "HMRC supports OAuth 2.0 for authenticating [User-restricted](https://developer.service.hmrc.gov.uk/api-documentation/docs/authorisation/user-restricted-endpoints)\
        \ API requests"
      flows:
        authorizationCode:
          authorizationUrl: https://api.service.hmrc.gov.uk/oauth/authorize
          tokenUrl: https://api.service.hmrc.gov.uk/oauth/token
          refreshUrl: https://api.service.hmrc.gov.uk/oauth/refresh
          scopes:
            write:self-assessment: Grant write access
            read:self-assessment: Grant read access
